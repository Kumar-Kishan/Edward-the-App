(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+XSZ":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.chaptersToPdf=void 0;var o=s(n("hhQR")),i=s(n("m1cH")),r=s(n("FyfS")),a=s(n("4d7F")),u=s(n("5JmO")),l=s(n("TruH")),c=s(n("JEAp"));function s(t){return t&&t.__esModule?t:{default:t}}u.default.vfs=l.default.pdfMake.vfs;e.chaptersToPdf=function(t,e){return new a.default(function(n){var a,l={content:[{text:t,style:"title"}],styles:{body:{fontSize:12},bold:{bold:!0},blockquote:{margin:[10,10,0,10]},chapterHeading:{fontSize:20,margin:[5,10]},h1:{fontSize:18},h2:{fontSize:16},h3:{fontSize:14},italic:{italics:!0},strike:{decoration:"lineThrough"},title:{fontSize:40},underline:{decoration:"underline"}}},s=[];function d(t,e){return{text:t||"",style:e||[]}}var f=!0,h=!1,A=void 0;try{for(var v,b=(0,r.default)(e);!(f=(v=b.next()).done);f=!0){var m=v.value;s.push({text:m.title,style:"chapterHeading",pageBreak:"before"});var x={text:[],style:[]},C=m.content&&m.content.ops||[],g=!0,y=!1,w=void 0;try{for(var k,B=(0,r.default)(C);!(g=(k=B.next()).done);g=!0){var _,T=k.value,S=T.insert,E=p(T.attributes),P=E.styles,D=E.lineStyles;if(D.length)(_=x.style).push.apply(_,(0,i.default)(D));if("\n"!==S)if(S.includes("\n")){var F=S.split("\n"),O=(0,o.default)(F),j=O[0],I=O.slice(1);if(j){var M=d(j,P);x.text.push(M)}s.push(x),x={text:[],style:[]};for(var J=0;J<I.length-1;J++){var N=d(I[J],P);x.text.push(N),s.push(x),x={text:[],style:[]}}var U=d(I[I.length-1],P);x.text.push(U)}else{var q=d(S,P);x.text.push(q)}else s.push(x),x={text:[],style:[]}}}catch(t){y=!0,w=t}finally{try{!g&&B.return&&B.return()}finally{if(y)throw w}}}}catch(t){h=!0,A=t}finally{try{!f&&b.return&&b.return()}finally{if(h)throw A}}var W=1;s.forEach(function(t){return t.style.includes("ul")?(t.ul=[{text:t.text}],W=1,t.text=null):t.style.includes("ol")?(t.ol=[{text:t.text}],t.start=W++,t.text=null):W=1,t}),l.content=(a=l.content).concat.apply(a,s),u.default.createPdf(l).getBlob(function(e){if(window&&window._integration)return window._pdfSuccess=!0,n();c.default.saveAs(e,t+".pdf"),n()})})};var d={bullet:"ul",ordered:"ol"};function p(t){var e=[],n=[];if(!t)return{styles:e,lineStyles:n};for(var o in t)["bold","italic","underline","strike"].includes(o)?e.push(o):"header"!==o?"blockquote"!==o?"list"!==o||n.push(d[t[o]]):n.push("blockquote"):n.push("h"+t[o]);return{styles:e,lineStyles:n}}},"3NqY":function(t,e,n){(t.exports=n("I1BE")(!0)).push([t.i,".wrap[data-v-6073a70b]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:100%}.exporter[data-v-6073a70b]{display:block;-webkit-box-flex:1;-ms-flex:1;flex:1;max-width:1050px}.export-option[data-v-6073a70b]{margin-bottom:16px}.export-checkbox[data-v-6073a70b]{margin-top:8px}.export-button[data-v-6073a70b]{margin:10px 0}.file-input-container[data-v-6073a70b]{cursor:pointer;display:inline-block;position:relative}.file-input-label[data-v-6073a70b]{bottom:0;cursor:pointer;left:0;opacity:0;padding:0;position:absolute;right:0;top:0}.file-input[data-v-6073a70b]{border:none;position:absolute;visibility:hidden}.file-dummy-button[data-v-6073a70b]{pointer-events:none}","",{version:3,sources:["C:/code/Edward-the-App/src/app/exporter/exporter.page.vue"],names:[],mappings:"AACA,uBACE,oBAAqB,AACrB,oBAAqB,AACrB,aAAc,AACd,wBAAyB,AACrB,qBAAsB,AAClB,uBAAwB,AAChC,UAAY,CACb,AACD,2BACE,cAAe,AACf,mBAAoB,AAChB,WAAY,AACR,OAAQ,AAChB,gBAAkB,CACnB,AACD,gCACE,kBAAoB,CACrB,AACD,kCACE,cAAgB,CACjB,AACD,gCACE,aAAe,CAChB,AACD,uCACE,eAAgB,AAChB,qBAAsB,AACtB,iBAAmB,CACpB,AACD,mCACE,SAAU,AACV,eAAgB,AAChB,OAAQ,AACR,UAAW,AACX,UAAW,AACX,kBAAmB,AACnB,QAAS,AACT,KAAO,CACR,AACD,6BACE,YAAa,AACb,kBAAmB,AACnB,iBAAmB,CACpB,AACD,oCACE,mBAAqB,CACtB",file:"exporter.page.vue",sourcesContent:["\n.wrap[data-v-6073a70b] {\r\n  display: -webkit-box;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -webkit-box-pack: center;\r\n      -ms-flex-pack: center;\r\n          justify-content: center;\r\n  width: 100%;\n}\n.exporter[data-v-6073a70b] {\r\n  display: block;\r\n  -webkit-box-flex: 1;\r\n      -ms-flex: 1;\r\n          flex: 1;\r\n  max-width: 1050px;\n}\n.export-option[data-v-6073a70b] {\r\n  margin-bottom: 16px;\n}\n.export-checkbox[data-v-6073a70b] {\r\n  margin-top: 8px;\n}\n.export-button[data-v-6073a70b] {\r\n  margin: 10px 0;\n}\n.file-input-container[data-v-6073a70b] {\r\n  cursor: pointer;\r\n  display: inline-block;\r\n  position: relative;\n}\n.file-input-label[data-v-6073a70b] {\r\n  bottom: 0;\r\n  cursor: pointer;\r\n  left: 0;\r\n  opacity: 0;\r\n  padding: 0;\r\n  position: absolute;\r\n  right: 0;\r\n  top: 0;\n}\n.file-input[data-v-6073a70b] {\r\n  border: none;\r\n  position: absolute;\r\n  visibility: hidden;\n}\n.file-dummy-button[data-v-6073a70b] {\r\n  pointer-events: none;\n}\r\n"],sourceRoot:""}])},Kuy8:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=h(n("m1cH")),i=h(n("GQeE")),r=n("aS18"),a=n("fyQS"),u=n("+XSZ"),l=n("j9tD"),c=h(n("il2d")),s=h(n("xweI")),d=n("UUVB"),p=h(n("GUC0")),f=h(n("bFnm"));function h(t){return t&&t.__esModule?t:{default:t}}e.default={components:{PulseLoader:c.default},computed:{allChapters:function(){return this.$store.state.chapters.chapters},allPlans:function(){return this.$store.state.chapters.plans},allTopics:function(){return this.$store.state.chapters.topics},allWorkshops:function(){return this.$store.state.workshop.workshops},documentGuid:function(){return this.$store.state.document.currentDocument.guid},documentTitle:function(){return this.$store.state.document.currentDocument.name},isPremium:function(){return this.$store.state.user.user.isPremium},masterTopics:function(){return this.$store.state.chapters.topics}},data:function(){return{includeArchived:!1,loading:!1}},methods:{importBackup:function(t){var e=this;this.loading=!0;var n=void 0;(0,r.jsonFileToBackup)(t).then(function(t){return(n=t).guid=e.documentGuid,n.name=e.documentTitle,d.storageApiPromise.then(function(t){return t.docImport(n)})}).then(function(t){e.loading=!1,(0,a.resetCache)(),(0,p.default)({icon:"success",text:"The document has been imported.",title:"Success"}).then(function(){return e.$store.dispatch(l.CHANGE_DOCUMENT,{guid:e.documentGuid,name:e.documentTitle})})},function(t){throw e.loading=!1,(0,p.default)({icon:"error",text:'Could not import the document. DETAILS: "'+t+'"',title:"Failure"}),t})},exportJsonDocument:function(){var t=this;this.loading=!0,d.storageApiPromise.then(function(e){return e.docExport(t.documentGuid,t.documentTitle)}).then(function(e){(0,r.backupToJsonFile)(t.documentTitle,e).then(function(){t.loading=!1},function(e){throw t.loading=!1,(0,p.default)({icon:"error",text:'Could not export the document. DETAILS: "'+e+'"'}),e})},function(e){throw t.loading=!1,(0,p.default)({icon:"error",text:'Could not export the document. DETAILS: "'+e+'"'}),e})},exportPdfChapters:function(){var t=this;this.loading=!0;var e=this.allChapters.filter(function(e){return!e.archived||t.includeArchived});(0,u.chaptersToPdf)(this.documentTitle,e).then(function(){t.loading=!1},function(e){throw t.loading=!1,(0,p.default)({icon:"error",text:'Could not export the document. DETAILS: "'+e+'"'}),e})},exportPdfOutlines:function(){var t,e=this;this.loading=!0;var n=this.allChapters.filter(function(t){return!t.archived||e.includeArchived}).map(function(t){return(0,i.default)(t.topics).map(function(n){var o=t.topics[n],i=e.getMasterTopic(o);return o.archived=i.archived,o.title=t.title+" - "+i.title,o}).filter(function(t){return!t.archived||e.includeArchived})}),r=(t=[]).concat.apply(t,(0,o.default)(n));(0,u.chaptersToPdf)(this.documentTitle+": Outlines",r).then(function(){e.loading=!1},function(t){throw e.loading=!1,(0,p.default)({icon:"error",text:'Could not export outlines. DETAILS: "'+t+'"'}),t})},exportPdfPlans:function(){var t,e=this;this.loading=!0;var n=this.allPlans.filter(function(t){return!t.archived||e.includeArchived}).map(function(t){return t.sections.filter(function(t){return!t.archived||e.includeArchived}).map(function(e){return{title:t.title===e.title?t.title:t.title+" - "+e.title,content:e.content}})}),i=(t=[]).concat.apply(t,(0,o.default)(n));(0,u.chaptersToPdf)(this.documentTitle+": Plans",i).then(function(){e.loading=!1},function(t){throw e.loading=!1,(0,p.default)({icon:"error",text:'Could not export plans. DETAILS: "'+t+'"'}),t})},exportPdfWorkshops:function(){var t=this;this.loading=!0;var e=this.allWorkshops.filter(function(e){return!e.archived||t.includeArchived}).map(function(t){return{content:t.content,date:t.date,guid:t.guid,order:t.order,title:f.default[t.workshopName].displayName+" ("+t.date.toString()+")",workshopName:t.workshopName}}),n=(0,s.default)(e,function(t){return t.workshopName+"-"+t.date.toString()+"-"+t.guid+"-"+t.order});(0,u.chaptersToPdf)(this.documentTitle+": Workshops",n).then(function(){t.loading=!1},function(e){throw t.loading=!1,(0,p.default)({icon:"error",text:'Could not export workshops. DETAILS: "'+e+'"'}),e})},getMasterTopic:function(t){return this.masterTopics.find(function(e){return e.guid===t.guid})},setFile:function(t){var e=this;(0,p.default)({buttons:!0,dangerMode:!0,icon:"warning",text:"Are you sure you want to import this file? It will overwrite everything in the current document.",title:"Overwrite current document?"}).then(function(n){n&&e.importBackup(t.target.files[0])})}}}},O9dL:function(t,e,n){"use strict";n.r(e);var o=n("Kuy8"),i=n.n(o);for(var r in o)"default"!==r&&function(t){n.d(e,t,function(){return o[t]})}(r);var a=n("U8Te"),u=n("JFUb");var l=function(t){n("SRBC")},c=Object(u.a)(i.a,a.a,a.b,!1,l,"data-v-6073a70b",null);e.default=c.exports},SRBC:function(t,e,n){var o=n("3NqY");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,n("SZ7m").default)("dbbb18ac",o,!0,{})},U8Te:function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return i});var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrap"},[n("div",{staticClass:"exporter"},[n("div",{staticClass:"export-option"},[n("h3",[t._v("Export to PDF")]),t._v(" "),n("div",[t._v("(You can open PDFs in Microsoft Word.)")]),t._v(" "),t.loading?n("pulse-loader"):t._e(),t._v(" "),n("div",{staticClass:"export-checkbox"},[t.loading?t._e():n("input",{directives:[{name:"model",rawName:"v-model",value:t.includeArchived,expression:"includeArchived"}],attrs:{id:"includeArchived",type:"checkbox"},domProps:{checked:Array.isArray(t.includeArchived)?t._i(t.includeArchived,null)>-1:t.includeArchived},on:{change:function(e){var n=t.includeArchived,o=e.target,i=!!o.checked;if(Array.isArray(n)){var r=t._i(n,null);o.checked?r<0&&(t.includeArchived=n.concat([null])):r>-1&&(t.includeArchived=n.slice(0,r).concat(n.slice(r+1)))}else t.includeArchived=i}}}),t._v(" "),t.loading?t._e():n("label",{attrs:{for:"includeArchived"}},[t._v("Include Archived")])]),t._v(" "),t.loading?t._e():[n("button",{staticClass:"button-green export-button",on:{click:function(e){t.exportPdfChapters()}}},[t._v("\n          Export all chapters\n        ")]),t._v(" "),n("button",{staticClass:"button-green export-button",on:{click:function(e){t.exportPdfPlans()}}},[t._v("\n          Export all plans\n        ")]),t._v(" "),n("button",{staticClass:"button-green export-button",on:{click:function(e){t.exportPdfOutlines()}}},[t._v("\n          Export all outlines\n        ")]),t._v(" "),t.isPremium?n("button",{staticClass:"button-green export-button",on:{click:function(e){t.exportPdfWorkshops()}}},[t._v("\n          Export all workshops\n        ")]):t._e()]],2),t._v(" "),n("div",{staticClass:"export-option"},[n("h3",[t._v("Create a backup")]),t._v(" "),n("div",[t._v("(You can recover your document from this file later.)")]),t._v(" "),t.loading?n("pulse-loader"):t._e(),t._v(" "),t.loading?t._e():n("button",{staticClass:"button-green export-button",on:{click:function(e){t.exportJsonDocument()}}},[t._v("\n        Export entire document\n      ")])],1),t._v(" "),n("div",{staticClass:"export-option"},[n("h3",[t._v("Import a backup")]),t._v(" "),n("div",[t._v("\n        (Warning: This will overwrite the current document completely, including all chapters, plans and outlines.)\n      ")]),t._v(" "),n("div",{staticClass:"file-input-container"},[t.loading?n("pulse-loader"):t._e(),t._v(" "),t.loading?t._e():[n("label",{staticClass:"file-input-label",attrs:{for:"import-file-picker"}}),t._v(" "),n("input",{staticClass:"file-input",attrs:{id:"import-file-picker",type:"file",accept:".json"},on:{change:t.setFile}}),t._v(" "),n("button",{staticClass:"button-green export-button file-dummy-button"},[t._v("\n            Import entire document\n          ")])]],2)])])])},i=[]},aS18:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.jsonFileToBackup=e.backupToJsonFile=void 0;var o=a(n("gDS+")),i=a(n("4d7F")),r=a(n("JEAp"));function a(t){return t&&t.__esModule?t:{default:t}}e.backupToJsonFile=function(t,e){return new i.default(function(n){var i=(0,o.default)(e),a=new Blob([i],{type:"application/json"}),u=new Date,l=u.getDate()+"."+(u.getMonth()+1)+"."+u.getFullYear();if(window&&window._integration)return window._pdfSuccess=!0,n();r.default.saveAs(a,t+"--"+l+".json"),n()})},e.jsonFileToBackup=function(t){return new i.default(function(e,n){var o=new FileReader;o.onload=function(){try{var t=o.result;e(JSON.parse(t))}catch(t){n(t)}},o.readAsText(t)})}}}]);
//# sourceMappingURL=3.b47d2e38ffc9e9e56dea.js.map