{"version":3,"sources":["webpack:///./src/app/exporter/pdf.js","webpack:///src/app/exporter/exporter.page.vue","webpack:///./src/app/exporter/exporter.page.vue","webpack:///./src/app/exporter/json.js","webpack:///./src/app/exporter/exporter.page.vue?c012"],"names":["__webpack_require__","_utilities","pdfMake","vfs","pdfFonts","chaptersToPdf","title","chapters","_promise2","default","resolve","_definition$content","definition","content","text","style","styles","body","fontSize","bold","blockquote","margin","chapterHeading","h1","h2","h3","italic","italics","strike","decoration","underline","splitContent","getStyledArrayFromChapters","counter","forEach","includes","ul","ol","start","concat","apply","_toConsumableArray3","createPdf","getBlob","blob","window","_integration","_pdfSuccess","FileSaver","saveAs","_json","_cache","_pdf","_document","_storageSwitch","components","PulseLoader","_PulseLoader2","computed","allChapters","this","$store","state","allPlans","plans","allWorkshops","workshop","workshops","documentGuid","document","currentDocument","guid","documentTitle","name","isPremium","user","masterTopics","topics","data","pdfIncludeArchived","loading","wordIncludeArchived","methods","importBackup","file","_this","backup","jsonFileToBackup","then","_backup","storageApiPromise","storage","docImport","resetCache","_sweetalert2","icon","dispatch","CHANGE_DOCUMENT","err","exportJsonDocument","_this2","docExport","backupToJsonFile","exportPdfChapters","_this3","chaptersToExport","filter","chapter","archived","exportPdfOutlines","_ref","_this4","nestedTopics","map","_keys2","topic","masterTopic","getMasterTopic","topicsArray","exportPdfPlans","_ref2","_this5","nestedPlans","plan","sections","section","planArray","exportPdfWorkshops","_this6","date","order","_writingWorkshop2","workshopName","displayName","toString","sortedWorkshops","_sortBy2","exportWordChapters","_this7","exportToWord","includeArchived","button","dangerMode","chapterTopic","find","setFile","event","_this8","buttons","willOverwrite","target","files","_node_modules_vue_loader_lib_runtime_component_normalizer__WEBPACK_IMPORTED_MODULE_2__","__vue_styles__","context","Component","Object","_babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_exporter_page_vue__WEBPACK_IMPORTED_MODULE_0___default","a","_node_modules_vue_loader_lib_template_compiler_index_id_data_v_30c0f930_hasScoped_true_optionsId_0_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_exporter_page_vue__WEBPACK_IMPORTED_MODULE_1__","__webpack_exports__","json","_stringify2","Blob","type","today","Date","getDate","getMonth","getFullYear","reject","reader","FileReader","onload","result","JSON","parse","e","readAsText","d","staticRenderFns","render","_vm","_h","$createElement","_c","_self","staticClass","_v","_e","directives","rawName","value","expression","attrs","id","domProps","checked","Array","isArray","_i","on","change","$event","$$a","$$el","$$c","$$i","slice","for","click","accept"],"mappings":"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","file":"static/js/8.f603d7fc46bdcc847b1d.js","sourcesContent":["import pdfMake from 'pdfmake/build/pdfmake'\r\nimport pdfFonts from 'pdfmake/build/vfs_fonts.js'\r\nimport FileSaver from 'file-saver'\r\nimport { getStyledArrayFromChapters } from '../../../utilities'\r\n\r\npdfMake.vfs = pdfFonts.pdfMake.vfs\r\n\r\nexport const chaptersToPdf = (title, chapters) => {\r\n  return new Promise((resolve) => {\r\n    const definition = {\r\n      content: [{\r\n        text: title,\r\n        style: 'title'\r\n      }],\r\n      styles: {\r\n        body: {\r\n          fontSize: 12\r\n        },\r\n        bold: {\r\n          bold: true\r\n        },\r\n        blockquote: {\r\n          margin: [10, 10, 0, 10]\r\n        },\r\n        chapterHeading: {\r\n          fontSize: 20,\r\n          margin: [5, 10]\r\n        },\r\n        h1: {\r\n          fontSize: 18\r\n        },\r\n        h2: {\r\n          fontSize: 16\r\n        },\r\n        h3: {\r\n          fontSize: 14\r\n        },\r\n        italic: {\r\n          italics: true\r\n        },\r\n        strike: {\r\n          decoration: 'lineThrough'\r\n        },\r\n        title: {\r\n          fontSize: 40\r\n        },\r\n        underline: {\r\n          decoration: 'underline'\r\n        }\r\n      }\r\n    }\r\n\r\n    const splitContent = getStyledArrayFromChapters(chapters)\r\n\r\n    let counter = 1\r\n    splitContent.forEach(content => {\r\n      if (content.style.includes('ul')) {\r\n        content.ul = [{ text: content.text }]\r\n        counter = 1\r\n        content.text = null\r\n      } else if (content.style.includes('ol')) {\r\n        content.ol = [{ text: content.text }]\r\n        content.start = counter++\r\n        content.text = null\r\n      } else {\r\n        counter = 1\r\n      }\r\n      return content\r\n    })\r\n\r\n    definition.content = definition.content.concat(...splitContent)\r\n\r\n    pdfMake.createPdf(definition).getBlob(blob => {\r\n      if (window && window._integration) {\r\n        window._pdfSuccess = true\r\n        return resolve()\r\n      }\r\n      FileSaver.saveAs(blob, `${title}.pdf`)\r\n      resolve()\r\n    })\r\n  })\r\n}\r\n","<template>\r\n  <div class=\"wrap\">\r\n    <div class=\"exporter\">\r\n      <div class=\"export-option\">\r\n        <h3>Export to PDF</h3>\r\n        <pulse-loader v-if=\"loading\"></pulse-loader>\r\n        <div class=\"export-checkbox\">\r\n          <input id=\"pdfIncludeArchived\" v-if=\"!loading\" type=\"checkbox\" v-model=\"pdfIncludeArchived\">\r\n          <label for=\"pdfIncludeArchived\" v-if=\"!loading\">Include Archived</label>\r\n        </div>\r\n        <template v-if=\"!loading\">\r\n          <button class=\"button-green export-button\" @click=\"exportPdfChapters()\">\r\n            Export all chapters\r\n          </button>\r\n          <button class=\"button-green export-button\" @click=\"exportPdfPlans()\">\r\n            Export all plans\r\n          </button>\r\n          <button class=\"button-green export-button\" @click=\"exportPdfOutlines()\">\r\n            Export all outlines\r\n          </button>\r\n          <button v-if=\"isPremium\" class=\"button-green export-button\" @click=\"exportPdfWorkshops()\">\r\n            Export all workshops\r\n          </button>\r\n        </template>\r\n      </div>\r\n      <div class=\"export-option\">\r\n        <h3>Export to Microsoft Word document</h3>\r\n        <div>(Premium users only)</div>\r\n        <pulse-loader v-if=\"loading\"></pulse-loader>\r\n        <div class=\"export-checkbox\">\r\n          <input id=\"wordIncludeArchived\" v-if=\"!loading\" type=\"checkbox\" v-model=\"wordIncludeArchived\">\r\n          <label for=\"wordIncludeArchived\" v-if=\"!loading\">Include Archived</label>\r\n        </div>\r\n        <template v-if=\"!loading\">\r\n          <button class=\"button-green export-button\" @click=\"exportWordChapters()\">\r\n            Export all chapters\r\n          </button>\r\n        </template>\r\n      </div>\r\n      <div class=\"export-option\">\r\n        <h3>Create a backup</h3>\r\n        <div>(You can recover your document from this file later.)</div>\r\n        <pulse-loader v-if=\"loading\"></pulse-loader>\r\n        <button v-if=\"!loading\" class=\"button-green export-button\" @click=\"exportJsonDocument()\">\r\n          Export entire document\r\n        </button>\r\n      </div>\r\n      <div class=\"export-option\">\r\n        <h3>Import a backup</h3>\r\n        <div>\r\n          (Warning: This will overwrite the current document completely, including all chapters, plans, outlines and workshops.)\r\n        </div>\r\n        <div class=\"file-input-container\">\r\n          <pulse-loader v-if=\"loading\"></pulse-loader>\r\n          <template v-if=\"!loading\">\r\n            <label for=\"import-file-picker\" class=\"file-input-label\"></label>\r\n            <input id=\"import-file-picker\" class=\"file-input\" type=\"file\" accept=\".json\" @change=\"setFile\">\r\n            <button class=\"button-green export-button file-dummy-button\">\r\n              Import entire document\r\n            </button>\r\n          </template>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { backupToJsonFile, jsonFileToBackup } from './json'\r\nimport { resetCache } from '../shared/cache'\r\nimport { chaptersToPdf } from './pdf'\r\nimport { CHANGE_DOCUMENT } from '../shared/document.store'\r\nimport PulseLoader from 'vue-spinner/src/PulseLoader.vue'\r\nimport sortBy from 'lodash/sortBy'\r\nimport { storageApiPromise } from '../api/storageSwitch'\r\nimport swal from 'sweetalert'\r\nimport writingWorkshops from '../../../models/writingWorkshop'\r\n\r\nexport default {\r\n  components: {\r\n    PulseLoader\r\n  },\r\n  computed: {\r\n    allChapters () {\r\n      return this.$store.state.chapters.chapters\r\n    },\r\n    allPlans () {\r\n      return this.$store.state.chapters.plans\r\n    },\r\n    allWorkshops () {\r\n      return this.$store.state.workshop.workshops\r\n    },\r\n    documentGuid () {\r\n      return this.$store.state.document.currentDocument.guid\r\n    },\r\n    documentTitle () {\r\n      return this.$store.state.document.currentDocument.name\r\n    },\r\n    isPremium () {\r\n      return this.$store.state.user.user.isPremium\r\n    },\r\n    masterTopics () {\r\n      return this.$store.state.chapters.topics\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      pdfIncludeArchived: false,\r\n      loading: false,\r\n      wordIncludeArchived: false\r\n    }\r\n  },\r\n  methods: {\r\n    importBackup (file) {\r\n      this.loading = true\r\n      let backup\r\n      jsonFileToBackup(file).then(_backup => {\r\n        backup = _backup\r\n        backup.guid = this.documentGuid\r\n        backup.name = this.documentTitle\r\n\r\n        return storageApiPromise.then(storage => {\r\n          return storage.docImport(backup)\r\n        })\r\n      }).then(backup => {\r\n        this.loading = false\r\n        resetCache()\r\n\r\n        swal({\r\n          icon: 'success',\r\n          text: 'The document has been imported.',\r\n          title: 'Success'\r\n        }).then(() => {\r\n          return this.$store.dispatch(CHANGE_DOCUMENT,\r\n            { guid: this.documentGuid, name: this.documentTitle }\r\n          )\r\n        })\r\n      }, err => {\r\n        this.loading = false\r\n        swal({\r\n          icon: 'error',\r\n          text: `Could not import the document. DETAILS: \"${err}\"`,\r\n          title: 'Failure'\r\n        })\r\n        throw err\r\n      })\r\n    },\r\n    exportJsonDocument () {\r\n      this.loading = true\r\n\r\n      storageApiPromise.then(storage => {\r\n        return storage.docExport(this.documentGuid, this.documentTitle)\r\n      }).then(backup => {\r\n        backupToJsonFile(this.documentTitle, backup).then(() => {\r\n          this.loading = false\r\n        }, err => {\r\n          this.loading = false\r\n          swal({\r\n            icon: 'error',\r\n            text: `Could not export the document. DETAILS: \"${err}\"`\r\n          })\r\n          throw err\r\n        })\r\n      }, err => {\r\n        this.loading = false\r\n        swal({\r\n          icon: 'error',\r\n          text: `Could not export the document. DETAILS: \"${err}\"`\r\n        })\r\n        throw err\r\n      })\r\n    },\r\n    exportPdfChapters () {\r\n      this.loading = true\r\n\r\n      const chaptersToExport = this.allChapters.filter(chapter =>\r\n        !chapter.archived || this.pdfIncludeArchived\r\n      )\r\n\r\n      chaptersToPdf(this.documentTitle, chaptersToExport).then(() => {\r\n        this.loading = false\r\n      }, err => {\r\n        this.loading = false\r\n        swal({\r\n          icon: 'error',\r\n          text: `Could not export the document. DETAILS: \"${err}\"`\r\n        })\r\n        throw err\r\n      })\r\n    },\r\n    exportPdfOutlines () {\r\n      this.loading = true\r\n\r\n      const nestedTopics = this.allChapters.filter(chapter =>\r\n        !chapter.archived || this.pdfIncludeArchived\r\n      ).map(chapter => {\r\n        const chapterTopics = Object.keys(chapter.topics).map(guid => {\r\n          const topic = chapter.topics[guid]\r\n          const masterTopic = this.getMasterTopic(topic)\r\n          topic.archived = masterTopic.archived\r\n          topic.title = `${chapter.title} - ${masterTopic.title}`\r\n          return topic\r\n        }).filter(topic =>\r\n          !topic.archived || this.pdfIncludeArchived\r\n        )\r\n\r\n        return chapterTopics\r\n      })\r\n\r\n      const topicsArray = [].concat(...nestedTopics)\r\n\r\n      chaptersToPdf(`${this.documentTitle}: Outlines`, topicsArray).then(() => {\r\n        this.loading = false\r\n      }, err => {\r\n        this.loading = false\r\n        swal({\r\n          icon: 'error',\r\n          text: `Could not export outlines. DETAILS: \"${err}\"`\r\n        })\r\n        throw err\r\n      })\r\n    },\r\n    exportPdfPlans () {\r\n      this.loading = true\r\n      const nestedPlans = this.allPlans.filter(plan =>\r\n        !plan.archived || this.pdfIncludeArchived\r\n      ).map(plan => {\r\n        return plan.sections.filter(section =>\r\n          !section.archived || this.pdfIncludeArchived\r\n        ).map(section => {\r\n          const title = plan.title === section.title\r\n            ? plan.title\r\n            : `${plan.title} - ${section.title}`\r\n\r\n          return {\r\n            title,\r\n            content: section.content\r\n          }\r\n        })\r\n      })\r\n\r\n      const planArray = [].concat(...nestedPlans)\r\n\r\n      chaptersToPdf(`${this.documentTitle}: Plans`, planArray).then(() => {\r\n        this.loading = false\r\n      }, err => {\r\n        this.loading = false\r\n        swal({\r\n          icon: 'error',\r\n          text: `Could not export plans. DETAILS: \"${err}\"`\r\n        })\r\n        throw err\r\n      })\r\n    },\r\n    exportPdfWorkshops () {\r\n      this.loading = true\r\n      const workshops = this.allWorkshops.filter(workshop =>\r\n        !workshop.archived || this.pdfIncludeArchived\r\n      ).map(workshop => {\r\n        return {\r\n          content: workshop.content,\r\n          date: workshop.date,\r\n          guid: workshop.guid,\r\n          order: workshop.order,\r\n          title: `${writingWorkshops[workshop.workshopName].displayName} (${workshop.date.toString()})`,\r\n          workshopName: workshop.workshopName\r\n        }\r\n      })\r\n\r\n      const sortedWorkshops = sortBy(workshops, workshop =>\r\n        `${workshop.workshopName}-${workshop.date.toString()}-${workshop.guid}-${workshop.order}`\r\n      )\r\n\r\n      chaptersToPdf(`${this.documentTitle}: Workshops`, sortedWorkshops).then(() => {\r\n        this.loading = false\r\n      }, err => {\r\n        this.loading = false\r\n        swal({\r\n          icon: 'error',\r\n          text: `Could not export workshops. DETAILS: \"${err}\"`\r\n        })\r\n        throw err\r\n      })\r\n    },\r\n    exportWordChapters () {\r\n      if (!this.isPremium) {\r\n        swal({\r\n          button: 'OK',\r\n          dangerMode: true,\r\n          icon: 'error',\r\n          text: `Only Premium users can export to a Microsoft Word document. Please upgrade to a Premium subscription to continue.`,\r\n          title: 'Not allowed'\r\n        })\r\n        return\r\n      }\r\n\r\n      this.loading = true\r\n      storageApiPromise.then(storage => {\r\n        return storage.exportToWord({\r\n          guid: this.documentGuid,\r\n          title: this.documentTitle,\r\n          includeArchived: this.wordIncludeArchived\r\n        })\r\n      }).then(() => {\r\n        this.loading = false\r\n      }, err => {\r\n        this.loading = false\r\n        swal({\r\n          icon: 'error',\r\n          text: `Could not export to Word. DETAILS: \"${err}\"`\r\n        })\r\n        throw err\r\n      })\r\n    },\r\n    getMasterTopic (chapterTopic) {\r\n      return this.masterTopics.find(topic => topic.guid === chapterTopic.guid)\r\n    },\r\n    setFile (event) {\r\n      swal({\r\n        buttons: true,\r\n        dangerMode: true,\r\n        icon: 'warning',\r\n        text: `Are you sure you want to import this file? It will overwrite everything in the current document.`,\r\n        title: 'Overwrite current document?'\r\n      }).then(willOverwrite => {\r\n        if (!willOverwrite) {\r\n          return\r\n        }\r\n\r\n        this.importBackup(event.target.files[0])\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.wrap {\r\n  display: flex;\r\n  justify-content: center;\r\n  width: 100%;\r\n}\r\n\r\n.exporter {\r\n  display: block;\r\n  flex: 1;\r\n  max-width: 1050px;\r\n}\r\n\r\n.export-option {\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.export-checkbox {\r\n  margin-top: 8px;\r\n}\r\n\r\n.export-button {\r\n  margin: 10px 0;\r\n}\r\n\r\n.file-input-container {\r\n  cursor: pointer;\r\n  display: inline-block;\r\n  position: relative;\r\n}\r\n\r\n.file-input-label {\r\n  bottom: 0;\r\n  cursor: pointer;\r\n  left: 0;\r\n  opacity: 0;\r\n  padding: 0;\r\n  position: absolute;\r\n  right: 0;\r\n  top: 0;\r\n}\r\n\r\n.file-input {\r\n  border: none;\r\n  position: absolute;\r\n  visibility: hidden;\r\n}\r\n\r\n.file-dummy-button {\r\n  pointer-events: none;\r\n}\r\n</style>\r\n","function injectStyle (context) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"id\\\":\\\"data-v-30c0f930\\\",\\\"scoped\\\":true,\\\"sourceMap\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./exporter.page.vue\")\n}\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./exporter.page.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./exporter.page.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-30c0f930\\\",\\\"hasScoped\\\":true,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./exporter.page.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-30c0f930\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../../../node_modules/vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n","import FileSaver from 'file-saver'\r\n\r\nexport const backupToJsonFile = (title, backup) => {\r\n  return new Promise((resolve) => {\r\n    const json = JSON.stringify(backup)\r\n    const blob = new Blob([json], { type: 'application/json' })\r\n    const today = new Date()\r\n    const date = `${today.getDate()}.${today.getMonth() + 1}.${today.getFullYear()}`\r\n\r\n    if (window && window._integration) {\r\n      window._pdfSuccess = true\r\n      return resolve()\r\n    }\r\n\r\n    FileSaver.saveAs(blob, `${title}--${date}.json`)\r\n    resolve()\r\n  })\r\n}\r\n\r\nexport const jsonFileToBackup = file => {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader()\r\n\r\n    reader.onload = () => {\r\n      try {\r\n        const json = reader.result\r\n        resolve(JSON.parse(json))\r\n      } catch (e) {\r\n        reject(e)\r\n      }\r\n    }\r\n    reader.readAsText(file)\r\n  })\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrap\"},[_c('div',{staticClass:\"exporter\"},[_c('div',{staticClass:\"export-option\"},[_c('h3',[_vm._v(\"Export to PDF\")]),_vm._v(\" \"),(_vm.loading)?_c('pulse-loader'):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"export-checkbox\"},[(!_vm.loading)?_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.pdfIncludeArchived),expression:\"pdfIncludeArchived\"}],attrs:{\"id\":\"pdfIncludeArchived\",\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.pdfIncludeArchived)?_vm._i(_vm.pdfIncludeArchived,null)>-1:(_vm.pdfIncludeArchived)},on:{\"change\":function($event){var $$a=_vm.pdfIncludeArchived,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.pdfIncludeArchived=$$a.concat([$$v]))}else{$$i>-1&&(_vm.pdfIncludeArchived=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.pdfIncludeArchived=$$c}}}}):_vm._e(),_vm._v(\" \"),(!_vm.loading)?_c('label',{attrs:{\"for\":\"pdfIncludeArchived\"}},[_vm._v(\"Include Archived\")]):_vm._e()]),_vm._v(\" \"),(!_vm.loading)?[_c('button',{staticClass:\"button-green export-button\",on:{\"click\":function($event){_vm.exportPdfChapters()}}},[_vm._v(\"\\n          Export all chapters\\n        \")]),_vm._v(\" \"),_c('button',{staticClass:\"button-green export-button\",on:{\"click\":function($event){_vm.exportPdfPlans()}}},[_vm._v(\"\\n          Export all plans\\n        \")]),_vm._v(\" \"),_c('button',{staticClass:\"button-green export-button\",on:{\"click\":function($event){_vm.exportPdfOutlines()}}},[_vm._v(\"\\n          Export all outlines\\n        \")]),_vm._v(\" \"),(_vm.isPremium)?_c('button',{staticClass:\"button-green export-button\",on:{\"click\":function($event){_vm.exportPdfWorkshops()}}},[_vm._v(\"\\n          Export all workshops\\n        \")]):_vm._e()]:_vm._e()],2),_vm._v(\" \"),_c('div',{staticClass:\"export-option\"},[_c('h3',[_vm._v(\"Export to Microsoft Word document\")]),_vm._v(\" \"),_c('div',[_vm._v(\"(Premium users only)\")]),_vm._v(\" \"),(_vm.loading)?_c('pulse-loader'):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"export-checkbox\"},[(!_vm.loading)?_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.wordIncludeArchived),expression:\"wordIncludeArchived\"}],attrs:{\"id\":\"wordIncludeArchived\",\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.wordIncludeArchived)?_vm._i(_vm.wordIncludeArchived,null)>-1:(_vm.wordIncludeArchived)},on:{\"change\":function($event){var $$a=_vm.wordIncludeArchived,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.wordIncludeArchived=$$a.concat([$$v]))}else{$$i>-1&&(_vm.wordIncludeArchived=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.wordIncludeArchived=$$c}}}}):_vm._e(),_vm._v(\" \"),(!_vm.loading)?_c('label',{attrs:{\"for\":\"wordIncludeArchived\"}},[_vm._v(\"Include Archived\")]):_vm._e()]),_vm._v(\" \"),(!_vm.loading)?[_c('button',{staticClass:\"button-green export-button\",on:{\"click\":function($event){_vm.exportWordChapters()}}},[_vm._v(\"\\n          Export all chapters\\n        \")])]:_vm._e()],2),_vm._v(\" \"),_c('div',{staticClass:\"export-option\"},[_c('h3',[_vm._v(\"Create a backup\")]),_vm._v(\" \"),_c('div',[_vm._v(\"(You can recover your document from this file later.)\")]),_vm._v(\" \"),(_vm.loading)?_c('pulse-loader'):_vm._e(),_vm._v(\" \"),(!_vm.loading)?_c('button',{staticClass:\"button-green export-button\",on:{\"click\":function($event){_vm.exportJsonDocument()}}},[_vm._v(\"\\n        Export entire document\\n      \")]):_vm._e()],1),_vm._v(\" \"),_c('div',{staticClass:\"export-option\"},[_c('h3',[_vm._v(\"Import a backup\")]),_vm._v(\" \"),_c('div',[_vm._v(\"\\n        (Warning: This will overwrite the current document completely, including all chapters, plans, outlines and workshops.)\\n      \")]),_vm._v(\" \"),_c('div',{staticClass:\"file-input-container\"},[(_vm.loading)?_c('pulse-loader'):_vm._e(),_vm._v(\" \"),(!_vm.loading)?[_c('label',{staticClass:\"file-input-label\",attrs:{\"for\":\"import-file-picker\"}}),_vm._v(\" \"),_c('input',{staticClass:\"file-input\",attrs:{\"id\":\"import-file-picker\",\"type\":\"file\",\"accept\":\".json\"},on:{\"change\":_vm.setFile}}),_vm._v(\" \"),_c('button',{staticClass:\"button-green export-button file-dummy-button\"},[_vm._v(\"\\n            Import entire document\\n          \")])]:_vm._e()],2)])])])}\nvar staticRenderFns = []\nexport { render, staticRenderFns }"],"sourceRoot":""}