(function(e){function t(t){for(var r,u,a=t[0],o=t[1],c=t[2],d=0,v=[];d<a.length;d++)u=a[d],Object.prototype.hasOwnProperty.call(s,u)&&s[u]&&v.push(s[u][0]),s[u]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);l&&l(t);while(v.length)v.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,a=1;a<n.length;a++){var o=n[a];0!==s[o]&&(r=!1)}r&&(i.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},s={admin:0},i=[];function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var l=o;i.push([2,"chunk-vendors"]),n()})({2:function(e,t,n){e.exports=n("eb59")},"223a":function(e,t,n){},"35db":function(e,t,n){"use strict";var r=n("223a"),s=n.n(r);s.a},"464c":function(e,t,n){},"4aa2":function(e,t,n){"use strict";var r=n("840c"),s=n.n(r);s.a},5462:function(e,t,n){"use strict";var r=n("464c"),s=n.n(r);s.a},"676b":function(e,t,n){},7877:function(e,t,n){},"840c":function(e,t,n){},a589:function(e,t,n){},eb59:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),s=n("8c4f"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("total-users"),n("hr"),n("space-overages"),n("hr"),n("premium-users"),n("hr"),n("unverified-users"),n("hr"),n("user-id"),n("hr"),n("backup-recover"),n("hr"),n("user-emails"),n("hr")],1)},u=[],a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),n("div",{staticClass:"pad"},[n("p",[e._v("Enter user ID:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.userId,expression:"userId"}],attrs:{type:"number"},domProps:{value:e.userId},on:{input:function(t){t.target.composing||(e.userId=t.target.value)}}})]),e.userId?n("div",[n("button",{staticClass:"button-green",on:{click:function(t){return e.getBackup()}}},[e._v(" Get backup for this user ")])]):e._e(),e.userId?n("div",[n("label",{attrs:{for:"dataRecoveryUpload"}},[e._v("Upload a backup for this user: ")]),n("input",{attrs:{id:"dataRecoveryUpload",type:"file",accept:".json"},on:{change:e.setFile}})]):e._e()])},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("strong",[e._v("Data Recovery")])])}],c=(n("99af"),n("d4ec")),l=n("bee2"),d=n("bc3a"),v=n.n(d),m=function(e){return"/api/admin/".concat(e)},p=function(){function e(){Object(c["a"])(this,e)}return Object(l["a"])(e,[{key:"simpleGet",value:function(e){return v.a.get(e).then((function(e){return e.data}))}},{key:"simplePost",value:function(e,t){return v.a.post(e,t).then((function(e){return e.data}))}},{key:"addEmail",value:function(e){var t=e.content,n=e.subject;return this.simplePost(m("emails/new"),{content:t,subject:n})}},{key:"deleteEmail",value:function(e){var t=e.id;return this.simplePost(m("emails/delete"),{id:t})}},{key:"getPendingEmails",value:function(){return this.simpleGet(m("emails/pending"))}},{key:"getUserEmails",value:function(){return this.simpleGet(m("emails/csv"))}},{key:"reviewEmail",value:function(e){var t=e.id;return this.simplePost(m("emails/review"),{id:t})}},{key:"sendEmail",value:function(e){var t=e.id;return this.simplePost(m("emails/send"),{id:t})}},{key:"deleteUnverifiedUsers",value:function(){return this.simplePost(m("delete-unverified"))}},{key:"getPremiumSignups",value:function(){return this.simpleGet(m("premium-signups"))}},{key:"getSpaceOverages",value:function(){return this.simpleGet(m("space-overages"))}},{key:"getTotalUsers",value:function(){return this.simpleGet(m("total-users"))}},{key:"getUnverifiedUsers",value:function(){return this.simpleGet(m("unverified-users"))}},{key:"compUser",value:function(e){var t=e.id,n=e.months;return this.simplePost(m("comp"),{id:t,months:n})}},{key:"getCompUsers",value:function(){return this.simpleGet(m("comp-users"))}},{key:"uncompUser",value:function(e){var t=e.id;return this.simplePost(m("uncomp"),{id:t})}},{key:"getBackup",value:function(e){var t=e.userId;return this.simpleGet(m("backup/".concat(t)))}},{key:"restoreBackup",value:function(e){var t=e.userId,n=e.documents;return this.simplePost(m("backup/restore"),{userId:t,documents:n})}},{key:"getUserId",value:function(e){var t=e.email;return this.simpleGet(m("user-id/".concat(t)))}}]),e}(),f=new p,h=n("2440"),_=n.n(h),g=n("1940"),b=n.n(g),y={data:function(){return{backupFile:null,userId:null}},methods:{getBackup:function(){var e=this;f.getBackup({userId:this.userId}).then((function(t){var n=JSON.stringify(t),r=new Blob([n],{type:"application/json"}),s=new Date,i="".concat(s.getDate(),".").concat(s.getMonth()+1,".").concat(s.getFullYear());_.a.saveAs(r,"ADMIN_BACKUP_".concat(e.userId,"--").concat(i,".json"))}))},importBackup:function(e){var t=this,n=new FileReader;n.onload=function(){try{var e=n.result,r=JSON.parse(e);f.restoreBackup({userId:t.userId,documents:r}).then((function(){b()("Backup was restored!")}),(function(e){throw e}))}catch(s){console.error(s)}},n.readAsText(e)},setFile:function(e){var t=this;b()({buttons:!0,dangerMode:!0,icon:"warning",text:"Are you sure you want to import this file? It will overwrite all of this user's content.",title:"Overwrite user content?"}).then((function(n){n&&t.importBackup(e.target.files[0])}))}}},E=y,w=(n("4aa2"),n("2877")),C=Object(w["a"])(E,a,o,!1,null,"e82971be",null),k=C.exports,U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"stat"},[n("p",[e._v("New Author account signups (limit 150):")]),e.users?n("p",{domProps:{textContent:e._s(e.usersDisplay)}}):e._e()])},P=[],j=(n("a15b"),n("d81d"),{beforeCreate:function(){var e=this;f.getPremiumSignups().then((function(t){e.users=t}),(function(t){e.error=t}))},computed:{usersDisplay:function(){return this.users&&this.users.map((function(e){return e.daysSinceUpdate||(e.daysSinceUpdate=Math.round((Date.now()-new Date(e.updated_at))/864e5)),"".concat(e.email," (updated ").concat(e.daysSinceUpdate," days ago)")})).join(", ")}},data:function(){return{users:null}}}),x=j,O=Object(w["a"])(x,U,P,!1,null,"7969b709",null),I=O.exports,S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"stat"},[null!=e.overages?n("div",[n("p",[e._v("Author Overages: "+e._s(e.overages.premiums.length))]),n("p",[e._v("Bestseller Overages: "+e._s(e.overages.golds.length))]),e.overages.premiums.length?n("p",[n("strong",[e._v("Author users over 20MB")])]):e._e(),e._l(e.overages.premiums,(function(t){return n("div",{key:t.id},[n("p",[e._v(" email: "+e._s(t.email)+" | id: "+e._s(t.id)+" | space: "+e._s(t.space_used)+" ")])])})),e.overages.golds.length?n("p",[n("strong",[e._v("Bestseller users over 250MB")])]):e._e(),e._l(e.overages.golds,(function(t){return n("div",{key:t.id},[n("p",[e._v(" email: "+e._s(t.email)+" | id: "+e._s(t.id)+" | space: "+e._s(t.space_used)+" ")])])}))],2):e._e(),e.error?n("div",{staticClass:"error",domProps:{textContent:e._s(e.error)}}):e._e()])},B=[],D={beforeCreate:function(){var e=this;f.getSpaceOverages().then((function(t){e.overages=t}),(function(t){e.error=t}))},data:function(){return{error:null,overages:null}}},$=D,A=Object(w["a"])($,S,B,!1,null,"1bb2e710",null),N=A.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"stat"},[null!==e.userCount?n("div",[e._m(0),n("p",[e._v("Demo: "+e._s(e.userCount.demo))]),n("p",[e._v("Dreamer: "+e._s(e.userCount.limited))]),n("p",[e._v("Author: "+e._s(e.userCount.premium))]),n("p",[e._v("Bestseller: "+e._s(e.userCount.gold))]),n("p",[e._v("Admin: "+e._s(e.userCount.admin))]),n("p",[e._v("TOTAL: "+e._s(e.totalUsers))])]):e._e(),e.error?n("div",{staticClass:"error",domProps:{textContent:e._s(e.error)}}):e._e()])},M=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("strong",[e._v("Users by type")])])}],T=(n("a9e3"),{beforeCreate:function(){var e=this;f.getTotalUsers().then((function(t){e.userCount=t}),(function(t){e.error=t}))},computed:{totalUsers:function(){return this.userCount?Number(this.userCount.demo)+Number(this.userCount.limited)+Number(this.userCount.premium)+Number(this.userCount.gold)+Number(this.userCount.admin):0}},data:function(){return{error:null,userCount:null}}}),R=T,F=Object(w["a"])(R,G,M,!1,null,"e9b0b5bc",null),J=F.exports,L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"stat"},[n("p",[e._v("Unverified users (limit 150):")]),e.users?n("p",{domProps:{textContent:e._s(e.usersDisplay)}}):e._e(),n("button",{staticClass:"button-green",on:{click:function(t){return e.deleteUnverified()}}},[e._v(" Delete unverified users older than 3 days ")]),e.success?n("div",{staticClass:"success"},[e._v(" Success! ")]):e._e(),e.error?n("div",{staticClass:"error",domProps:{textContent:e._s(e.error)}}):e._e()])},K=[],V={beforeCreate:function(){var e=this;f.getUnverifiedUsers().then((function(t){e.users=t}),(function(t){e.error=t}))},computed:{usersDisplay:function(){return this.users&&this.users.map((function(e){return e.daysUnverified||(e.daysUnverified=Math.round((Date.now()-new Date(e.created_at))/864e5)),"".concat(e.email," (").concat(e.daysUnverified," days)")})).join(", ")}},data:function(){return{error:null,success:!1,users:null}},methods:{deleteUnverified:function(){var e=this;this.error=!1,this.success=!1,f.deleteUnverifiedUsers().then((function(){e.success=!0}),(function(t){e.error=t}))}}},Y=V,q=Object(w["a"])(Y,L,K,!1,null,"48c4f57c",null),z=q.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("p",[e._v("Export user emails as CSV for upload to Mailgun:")]),n("button",{staticClass:"button-green",on:{click:function(t){return e.getUserEmails()}}},[e._v(" Export ")]),e.error?n("div",{staticClass:"error",domProps:{textContent:e._s(e.error)}}):e._e(),n("hr"),e.pendingEmails?n("div",[n("p",[e._v("Pending emails:")]),e.pendingEmails.length?e._e():n("p",[e._v(" (none) ")]),e._l(e.pendingEmails,(function(t){return n("div",{key:t.id},[n("span",[n("strong",{domProps:{textContent:e._s(t.subject)}})]),n("button",{staticClass:"button-green",on:{click:function(n){return e.reviewEmail(t.id)}}},[e._v(" Review ")]),n("button",{staticClass:"button-red",on:{click:function(n){return e.deleteEmail(t.id)}}},[e._v(" Delete ")]),e.reviewedId===t.id?n("span",[e._v("Sent")]):e._e()])}))],2):e._e(),n("hr"),n("div",{staticClass:"new-email"},[n("p",[e._v("Create a new email:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.newEmail.subject,expression:"newEmail.subject"}],attrs:{type:"text",placeholder:"subject"},domProps:{value:e.newEmail.subject},on:{input:function(t){t.target.composing||e.$set(e.newEmail,"subject",t.target.value)}}}),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newEmail.content,expression:"newEmail.content"}],attrs:{placeholder:"content"},domProps:{value:e.newEmail.content},on:{input:function(t){t.target.composing||e.$set(e.newEmail,"content",t.target.value)}}}),e._v(" "),n("button",{staticClass:"button-green",on:{click:function(t){return e.createEmail()}}},[e._v(" Create ")]),e.success?n("div",{staticClass:"success"},[e._v(" Success! ")]):e._e()])])},Q=[],W={created:function(){this.getPendingEmails()},data:function(){return{error:null,newEmail:{content:null,subject:null},pendingEmails:null,reviewedId:null,success:!1}},methods:{createEmail:function(){var e=this;this.error=null,this.success=!1,f.addEmail({content:this.newEmail.content,subject:this.newEmail.subject}).then((function(){e.success=!0,e.newEmail.content=null,e.newEmail.subject=null,e.getPendingEmails()}),(function(t){e.error=t}))},deleteEmail:function(e){var t=this;this.error=null,f.deleteEmail({id:e}).then((function(){t.getPendingEmails()}),(function(e){t.error=e}))},getPendingEmails:function(){var e=this;this.error=null,f.getPendingEmails().then((function(t){e.pendingEmails=t}),(function(t){e.error=t}))},getUserEmails:function(){var e=this;this.error=null,f.getUserEmails().then((function(e){_.a.saveAs(new Blob([e],{type:"text/csv;charset=utf-8"}),"emails-private.csv")}),(function(t){e.error=t}))},reviewEmail:function(e){var t=this;this.error=null,this.reviewedId=null,f.reviewEmail({id:e}).then((function(){t.reviewedId=e}),(function(e){t.error=e}))}}},X=W,Z=(n("fc45"),Object(w["a"])(X,H,Q,!1,null,"59675921",null)),ee=Z.exports,te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.userEmail,expression:"userEmail"}],attrs:{type:"text",placeholder:"bob@example.com"},domProps:{value:e.userEmail},on:{input:function(t){t.target.composing||(e.userEmail=t.target.value)}}})]),n("div",[n("button",{staticClass:"button-green",on:{click:function(t){return e.getUserId()}}},[e._v(" Get user ID ")])]),e.matchingUsers&&e.matchingUsers.length?n("div",e._l(e.matchingUsers,(function(t){return n("div",{key:t.id},[e._v(" "+e._s(t.email)+": "+e._s(t.id)+" ")])})),0):n("div",[e._v(" No matching users found. ")])])},ne=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("strong",[e._v("Get user ID by %email% (limit 50):")])])}],re={data:function(){return{userEmail:null,matchingUsers:null}},methods:{getUserId:function(){var e=this;f.getUserId({email:this.userEmail}).then((function(t){e.matchingUsers=t}))}}},se=re,ie=Object(w["a"])(se,te,ne,!1,null,"40509012",null),ue=ie.exports,ae={components:{BackupRecover:k,PremiumUsers:I,SpaceOverages:N,TotalUsers:J,UnverifiedUsers:z,UserEmails:ee,UserId:ue},data:function(){return{}}},oe=ae,ce=Object(w["a"])(oe,i,u,!1,null,null,null),le=ce.exports,de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrap"},[e.error||e.success?e._e():n("div",[n("pulse-loader")],1),e.error?n("div",[n("h4",[e._v(" Email failed to send. ")]),n("p",{domProps:{textContent:e._s(e.error)}})]):e._e(),e.success?n("div",[n("h4",[e._v(" Email sent. ")])]):e._e(),n("router-link",{attrs:{to:"/overview"}},[e._v(" Back to overview ")])],1)},ve=[],me=n("8a5d"),pe={beforeCreate:function(){var e=this,t=this.$route.params.id;f.sendEmail({id:t}).then((function(){e.success=!0}),(function(t){e.error=t}))},components:{PulseLoader:me["a"]},data:function(){return{error:null,success:!1}}},fe=pe,he=(n("5462"),Object(w["a"])(fe,de,ve,!1,null,"083f4178",null)),_e=he.exports;r["a"].use(s["a"]);var ge=new s["a"]({routes:[{path:"/",redirect:"/overview"},{path:"/overview",name:"Overview",component:le},{path:"/send-email/:id",name:"Send Email",component:_e}]}),be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrap"},[n("h4",[e._v("This is a restricted Admin page.")]),n("hr"),n("router-view")],1)},ye=[],Ee={data:function(){return{}}},we=Ee,Ce=(n("35db"),Object(w["a"])(we,be,ye,!1,null,"f620c952",null)),ke=Ce.exports;n("a589"),n("676b");r["a"].config.productionTip=!1,new r["a"]({el:"#app",components:{Admin:ke},router:ge,render:function(e){return e("Admin")}})},fc45:function(e,t,n){"use strict";var r=n("7877"),s=n.n(r);s.a}});
//# sourceMappingURL=admin.e73b7a43.js.map