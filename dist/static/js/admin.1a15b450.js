(function(e){function t(t){for(var r,o,u=t[0],a=t[1],c=t[2],d=0,m=[];d<u.length;d++)o=u[d],s[o]&&m.push(s[o][0]),s[o]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);l&&l(t);while(m.length)m.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,u=1;u<n.length;u++){var a=n[u];0!==s[a]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},s={admin:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],a=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var l=a;i.push([2,"chunk-vendors"]),n()})({"0d79":function(e,t,n){},1452:function(e,t,n){},1486:function(e,t,n){"use strict";var r=n("d765"),s=n.n(r);s.a},2:function(e,t,n){e.exports=n("eb59")},"24f7":function(e,t,n){"use strict";var r=n("503d"),s=n.n(r);s.a},2521:function(e,t,n){},"503d":function(e,t,n){},"5b0d":function(e,t,n){},"5bf4":function(e,t,n){"use strict";var r=n("9ad5"),s=n.n(r);s.a},"676b":function(e,t,n){},"6f93":function(e,t,n){"use strict";var r=n("8e46"),s=n.n(r);s.a},7495:function(e,t,n){"use strict";var r=n("1452"),s=n.n(r);s.a},8398:function(e,t,n){"use strict";var r=n("f24c"),s=n.n(r);s.a},"8e46":function(e,t,n){},"9ad5":function(e,t,n){},abde:function(e,t,n){"use strict";var r=n("2521"),s=n.n(r);s.a},aeb1:function(e,t,n){"use strict";var r=n("be31"),s=n.n(r);s.a},b0d8:function(e,t,n){"use strict";var r=n("5b0d"),s=n.n(r);s.a},bde7:function(e,t,n){},be31:function(e,t,n){},c560:function(e,t,n){"use strict";var r=n("bde7"),s=n.n(r);s.a},d765:function(e,t,n){},db43:function(e,t,n){},e15b:function(e,t,n){"use strict";var r=n("0d79"),s=n.n(r);s.a},eb59:function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d");var r=n("2b0e"),s=n("8c4f"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("total-users"),n("hr"),n("space-overages"),n("hr"),n("premium-users"),n("hr"),n("unverified-users"),n("hr"),n("user-id"),n("hr"),n("backup-recover"),n("hr"),n("user-emails"),n("hr")],1)},o=[],u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),n("div",{staticClass:"pad"},[n("p",[e._v("Enter user ID:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.userId,expression:"userId"}],attrs:{type:"number"},domProps:{value:e.userId},on:{input:function(t){t.target.composing||(e.userId=t.target.value)}}})]),e.userId?n("div",[n("button",{staticClass:"button-green",on:{click:function(t){e.getBackup()}}},[e._v("Get backup for this user")])]):e._e(),e.userId?n("div",[n("label",{attrs:{for:"dataRecoveryUpload"}},[e._v("Upload a backup for this user: ")]),n("input",{attrs:{id:"dataRecoveryUpload",type:"file",accept:".json"},on:{change:e.setFile}})]):e._e()])},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("strong",[e._v("Data Recovery")])])}],c=n("d4ec"),l=n("bee2"),d=n("bc3a"),m=n.n(d),v=function(e){return"/api/admin/".concat(e)},p=function(){function e(){Object(c["a"])(this,e)}return Object(l["a"])(e,[{key:"simpleGet",value:function(e){return m.a.get(e).then(function(e){return e.data})}},{key:"simplePost",value:function(e,t){return m.a.post(e,t).then(function(e){return e.data})}},{key:"addEmail",value:function(e){var t=e.content,n=e.subject;return this.simplePost(v("emails/new"),{content:t,subject:n})}},{key:"deleteEmail",value:function(e){var t=e.id;return this.simplePost(v("emails/delete"),{id:t})}},{key:"getPendingEmails",value:function(){return this.simpleGet(v("emails/pending"))}},{key:"getUserEmails",value:function(){return this.simpleGet(v("emails/csv"))}},{key:"reviewEmail",value:function(e){var t=e.id;return this.simplePost(v("emails/review"),{id:t})}},{key:"sendEmail",value:function(e){var t=e.id;return this.simplePost(v("emails/send"),{id:t})}},{key:"deleteUnverifiedUsers",value:function(){return this.simplePost(v("delete-unverified"))}},{key:"getPremiumSignups",value:function(){return this.simpleGet(v("premium-signups"))}},{key:"getSpaceOverages",value:function(){return this.simpleGet(v("space-overages"))}},{key:"getTotalUsers",value:function(){return this.simpleGet(v("total-users"))}},{key:"getUnverifiedUsers",value:function(){return this.simpleGet(v("unverified-users"))}},{key:"compUser",value:function(e){var t=e.id,n=e.months;return this.simplePost(v("comp"),{id:t,months:n})}},{key:"getCompUsers",value:function(){return this.simpleGet(v("comp-users"))}},{key:"uncompUser",value:function(e){var t=e.id;return this.simplePost(v("uncomp"),{id:t})}},{key:"getBackup",value:function(e){var t=e.userId;return this.simpleGet(v("backup/".concat(t)))}},{key:"restoreBackup",value:function(e){var t=e.userId,n=e.documents;return this.simplePost(v("backup/restore"),{userId:t,documents:n})}},{key:"getUserId",value:function(e){var t=e.email;return this.simpleGet(v("user-id/".concat(t)))}}]),e}(),f=new p,h=n("2440"),_=n.n(h),g=n("1940"),b=n.n(g),y={data:function(){return{backupFile:null,userId:null}},methods:{getBackup:function(){var e=this;f.getBackup({userId:this.userId}).then(function(t){var n=JSON.stringify(t),r=new Blob([n],{type:"application/json"}),s=new Date,i="".concat(s.getDate(),".").concat(s.getMonth()+1,".").concat(s.getFullYear());_.a.saveAs(r,"ADMIN_BACKUP_".concat(e.userId,"--").concat(i,".json"))})},importBackup:function(e){var t=this,n=new FileReader;n.onload=function(){try{var e=n.result,r=JSON.parse(e);f.restoreBackup({userId:t.userId,documents:r}).then(function(){b()("Backup was restored!")},function(e){throw e})}catch(s){console.error(s)}},n.readAsText(e)},setFile:function(e){var t=this;b()({buttons:!0,dangerMode:!0,icon:"warning",text:"Are you sure you want to import this file? It will overwrite all of this user's content.",title:"Overwrite user content?"}).then(function(n){n&&t.importBackup(e.target.files[0])})}}},E=y,w=(n("b0d8"),n("2877")),C=Object(w["a"])(E,u,a,!1,null,"ac7cc1ac",null);C.options.__file="BackupRecover.page.vue";var U=C.exports,k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("p",[e._v("Accounts with a payment due date over 35 days from today:")]),e.compUsers&&e.compUsers.length?e._e():n("p",[e._v("(none)")]),e._l(e.compUsers,function(t){return n("div",{key:t.id},[n("span",[e._v("\n      "+e._s(t.email)+" (due "+e._s(t.payment_period_end)+")\n    ")]),n("button",{staticClass:"button-red",on:{click:function(n){e.uncomp(t.id)}}},[e._v("Uncomp")])])}),e.error?n("p",{staticClass:"error",domProps:{textContent:e._s(e.error)}}):e._e(),n("hr"),n("div",{staticClass:"comp-form"},[n("p",[e._v("Comp an account:")]),n("div",{staticClass:"comp-form"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.userId,expression:"userId"}],attrs:{type:"number",placeholder:"User ID"},domProps:{value:e.userId},on:{input:function(t){t.target.composing||(e.userId=t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.months,expression:"months"}],attrs:{type:"number",placeholder:"# of months to comp"},domProps:{value:e.months},on:{input:function(t){t.target.composing||(e.months=t.target.value)}}}),n("button",{staticClass:"button-green",on:{click:function(t){e.comp()}}},[e._v("Comp this user")])]),e.compError?n("div",{staticClass:"error",domProps:{textContent:e._s(e.compError)}}):e._e()])],2)},x=[],P={created:function(){this.getCompUsers()},data:function(){return{compError:null,compUsers:null,error:null,months:null,userId:null}},methods:{comp:function(){var e=this;this.compError=!1,f.compUser({id:this.userId,months:this.months}).then(function(){e.months=null,e.userId=null,e.getCompUsers()},function(t){e.compError=t})},getCompUsers:function(){var e=this;f.getCompUsers().then(function(t){e.compUsers=t},function(t){e.error=t})},uncomp:function(e){var t=this;b()({buttons:!0,dangerMode:!0,icon:"warning",text:"Are you sure? This user's next payment will be due in 1 month.",title:"Uncomp user?"}).then(function(n){n&&(t.error=null,f.uncompUser({id:e}).then(function(){t.getCompUsers()},function(e){t.error=e}))})}}},j=P,I=(n("8398"),Object(w["a"])(j,k,x,!1,null,"24ff07ef",null));I.options.__file="CompAccounts.vue";var O=I.exports,S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"stat"},[n("p",[e._v("New Author account signups (limit 150):")]),e.users?n("p",{domProps:{textContent:e._s(e.usersDisplay)}}):e._e()])},A=[],B={beforeCreate:function(){var e=this;f.getPremiumSignups().then(function(t){e.users=t},function(t){e.error=t})},computed:{usersDisplay:function(){return this.users&&this.users.map(function(e){return e.daysSinceUpdate||(e.daysSinceUpdate=Math.round((Date.now()-new Date(e.updated_at))/864e5)),"".concat(e.email," (updated ").concat(e.daysSinceUpdate," days ago)")}).join(", ")}},data:function(){return{users:null}}},D=B,$=(n("c560"),Object(w["a"])(D,S,A,!1,null,"220e1086",null));$.options.__file="PremiumUsers.vue";var N=$.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"stat"},[null!=e.overages?n("div",[n("p",[e._v("Author Overages: "+e._s(e.overages.premiums.length))]),n("p",[e._v("Bestseller Overages: "+e._s(e.overages.golds.length))]),e.overages.premiums.length?n("p",[n("strong",[e._v("Author users over 20MB")])]):e._e(),e._l(e.overages.premiums,function(t){return n("div",{key:t.id},[n("p",[e._v("\n        email: "+e._s(t.email)+" | id: "+e._s(t.id)+" | space: "+e._s(t.space_used)+"\n      ")])])}),e.overages.golds.length?n("p",[n("strong",[e._v("Bestseller users over 250MB")])]):e._e(),e._l(e.overages.golds,function(t){return n("div",{key:t.id},[n("p",[e._v("\n        email: "+e._s(t.email)+" | id: "+e._s(t.id)+" | space: "+e._s(t.space_used)+"\n      ")])])})],2):e._e(),e.error?n("div",{staticClass:"error",domProps:{textContent:e._s(e.error)}}):e._e()])},M=[],T={beforeCreate:function(){var e=this;f.getSpaceOverages().then(function(t){e.overages=t},function(t){e.error=t})},data:function(){return{error:null,overages:null}}},R=T,F=(n("5bf4"),Object(w["a"])(R,G,M,!1,null,"0cfeeb39",null));F.options.__file="SpaceOverages.vue";var J=F.exports,L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"stat"},[null!==e.userCount?n("div",[e._m(0),n("p",[e._v("Demo: "+e._s(e.userCount.demo))]),n("p",[e._v("Dreamer: "+e._s(e.userCount.limited))]),n("p",[e._v("Author: "+e._s(e.userCount.premium))]),n("p",[e._v("Bestseller: "+e._s(e.userCount.gold))]),n("p",[e._v("Admin: "+e._s(e.userCount.admin))]),n("p",[e._v("TOTAL: "+e._s(e.totalUsers))])]):e._e(),e.error?n("div",{staticClass:"error",domProps:{textContent:e._s(e.error)}}):e._e()])},K=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("strong",[e._v("Users by type")])])}],V=(n("c5f6"),{beforeCreate:function(){var e=this;f.getTotalUsers().then(function(t){e.userCount=t},function(t){e.error=t})},computed:{totalUsers:function(){return this.userCount?Number(this.userCount.demo)+Number(this.userCount.limited)+Number(this.userCount.premium)+Number(this.userCount.gold)+Number(this.userCount.admin):0}},data:function(){return{error:null,userCount:null}}}),Y=V,q=(n("aeb1"),Object(w["a"])(Y,L,K,!1,null,"3da49585",null));q.options.__file="TotalUsers.vue";var z=q.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"stat"},[n("p",[e._v("Unverified users (limit 150):")]),e.users?n("p",{domProps:{textContent:e._s(e.usersDisplay)}}):e._e(),n("button",{staticClass:"button-green",on:{click:function(t){e.deleteUnverified()}}},[e._v("Delete unverified users older than 3 days")]),e.success?n("div",{staticClass:"success"},[e._v("Success!")]):e._e(),e.error?n("div",{staticClass:"error",domProps:{textContent:e._s(e.error)}}):e._e()])},Q=[],W={beforeCreate:function(){var e=this;f.getUnverifiedUsers().then(function(t){e.users=t},function(t){e.error=t})},computed:{usersDisplay:function(){return this.users&&this.users.map(function(e){return e.daysUnverified||(e.daysUnverified=Math.round((Date.now()-new Date(e.created_at))/864e5)),"".concat(e.email," (").concat(e.daysUnverified," days)")}).join(", ")}},data:function(){return{error:null,success:!1,users:null}},methods:{deleteUnverified:function(){var e=this;this.error=!1,this.success=!1,f.deleteUnverifiedUsers().then(function(){e.success=!0},function(t){e.error=t})}}},X=W,Z=(n("7495"),Object(w["a"])(X,H,Q,!1,null,"2acd6f88",null));Z.options.__file="UnverifiedUsers.vue";var ee=Z.exports,te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("p",[e._v("Export user emails as CSV for upload to Mailgun:")]),n("button",{staticClass:"button-green",on:{click:function(t){e.getUserEmails()}}},[e._v("Export")]),e.error?n("div",{staticClass:"error",domProps:{textContent:e._s(e.error)}}):e._e(),n("hr"),e.pendingEmails?n("div",[n("p",[e._v("Pending emails:")]),e.pendingEmails.length?e._e():n("p",[e._v("(none)")]),e._l(e.pendingEmails,function(t){return n("div",{key:t.id},[n("span",[n("strong",{domProps:{textContent:e._s(t.subject)}})]),n("button",{staticClass:"button-green",on:{click:function(n){e.reviewEmail(t.id)}}},[e._v("Review")]),n("button",{staticClass:"button-red",on:{click:function(n){e.deleteEmail(t.id)}}},[e._v("Delete")]),e.reviewedId===t.id?n("span",[e._v("Sent")]):e._e()])})],2):e._e(),n("hr"),n("div",{staticClass:"new-email"},[n("p",[e._v("Create a new email:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.newEmail.subject,expression:"newEmail.subject"}],attrs:{type:"text",placeholder:"subject"},domProps:{value:e.newEmail.subject},on:{input:function(t){t.target.composing||e.$set(e.newEmail,"subject",t.target.value)}}}),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newEmail.content,expression:"newEmail.content"}],attrs:{placeholder:"content"},domProps:{value:e.newEmail.content},on:{input:function(t){t.target.composing||e.$set(e.newEmail,"content",t.target.value)}}}),n("button",{staticClass:"button-green",on:{click:function(t){e.createEmail()}}},[e._v("Create")]),e.success?n("div",{staticClass:"success"},[e._v("Success!")]):e._e()])])},ne=[],re={created:function(){this.getPendingEmails()},data:function(){return{error:null,newEmail:{content:null,subject:null},pendingEmails:null,reviewedId:null,success:!1}},methods:{createEmail:function(){var e=this;this.error=null,this.success=!1,f.addEmail({content:this.newEmail.content,subject:this.newEmail.subject}).then(function(){e.success=!0,e.newEmail.content=null,e.newEmail.subject=null,e.getPendingEmails()},function(t){e.error=t})},deleteEmail:function(e){var t=this;this.error=null,f.deleteEmail({id:e}).then(function(){t.getPendingEmails()},function(e){t.error=e})},getPendingEmails:function(){var e=this;this.error=null,f.getPendingEmails().then(function(t){e.pendingEmails=t},function(t){e.error=t})},getUserEmails:function(){var e=this;this.error=null,f.getUserEmails().then(function(e){_.a.saveAs(new Blob([e],{type:"text/csv;charset=utf-8"}),"emails-private.csv")},function(t){e.error=t})},reviewEmail:function(e){var t=this;this.error=null,this.reviewedId=null,f.reviewEmail({id:e}).then(function(){t.reviewedId=e},function(e){t.error=e})}}},se=re,ie=(n("24f7"),Object(w["a"])(se,te,ne,!1,null,"edb67460",null));ie.options.__file="UserEmails.vue";var oe=ie.exports,ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.userEmail,expression:"userEmail"}],attrs:{type:"text",placeholder:"bob@example.com"},domProps:{value:e.userEmail},on:{input:function(t){t.target.composing||(e.userEmail=t.target.value)}}})]),n("div",[n("button",{staticClass:"button-green",on:{click:function(t){e.getUserId()}}},[e._v("Get user ID")])]),e.matchingUsers&&e.matchingUsers.length?n("div",e._l(e.matchingUsers,function(t){return n("div",{key:t.id},[e._v("\n      "+e._s(t.email)+": "+e._s(t.id)+"\n    ")])})):n("div",[e._v("\n    No matching users found.\n  ")])])},ae=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("strong",[e._v("Get user ID by %email% (limit 50):")])])}],ce={data:function(){return{userEmail:null,matchingUsers:null}},methods:{getUserId:function(){var e=this;f.getUserId({email:this.userEmail}).then(function(t){e.matchingUsers=t})}}},le=ce,de=(n("e15b"),Object(w["a"])(le,ue,ae,!1,null,"ab39ef96",null));de.options.__file="UserId.vue";var me=de.exports,ve={components:{BackupRecover:U,CompAccounts:O,PremiumUsers:N,SpaceOverages:J,TotalUsers:z,UnverifiedUsers:ee,UserEmails:oe,UserId:me},data:function(){return{}}},pe=ve,fe=(n("1486"),Object(w["a"])(pe,i,o,!1,null,null,null));fe.options.__file="overview.page.vue";var he=fe.exports,_e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrap"},[e.error||e.success?e._e():n("div",[n("pulse-loader")],1),e.error?n("div",[n("h4",[e._v("\n      Email failed to send.\n    ")]),n("p",{domProps:{textContent:e._s(e.error)}})]):e._e(),e.success?n("div",[n("h4",[e._v("\n      Email sent.\n    ")])]):e._e(),n("router-link",{attrs:{to:"/overview"}},[e._v("\n    Back to overview\n  ")])],1)},ge=[],be=n("8a5d"),ye={beforeCreate:function(){var e=this,t=this.$route.params.id;f.sendEmail({id:t}).then(function(){e.success=!0},function(t){e.error=t})},components:{PulseLoader:be["a"]},data:function(){return{error:null,success:!1}}},Ee=ye,we=(n("6f93"),Object(w["a"])(Ee,_e,ge,!1,null,"1e8e70c6",null));we.options.__file="sendEmail.page.vue";var Ce=we.exports;r["a"].use(s["a"]);var Ue=new s["a"]({routes:[{path:"/",redirect:"/overview"},{path:"/overview",name:"Overview",component:he},{path:"/send-email/:id",name:"Send Email",component:Ce}]}),ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrap"},[n("h4",[e._v("This is a restricted Admin page.")]),n("hr"),n("router-view")],1)},xe=[],Pe={data:function(){return{}}},je=Pe,Ie=(n("abde"),Object(w["a"])(je,ke,xe,!1,null,"526cb3ca",null));Ie.options.__file="Admin.vue";var Oe=Ie.exports;n("db43"),n("676b");r["a"].config.productionTip=!1,new r["a"]({el:"#app",components:{Admin:Oe},router:Ue,render:function(e){return e("Admin")}})},f24c:function(e,t,n){}});
//# sourceMappingURL=admin.1a15b450.js.map