{"version":3,"sources":["webpack:///./src/app/analyser/analyser.page.vue","webpack:///./src/app/analyser/analyser.page.vue?b1db","webpack:///./src/app/analyser/commonWords.analysis.js","webpack:///./src/app/analyser/analyses.js","webpack:///./src/app/analyser/wordOverTime.analysis.js","webpack:///src/app/analyser/analyser.page.vue"],"names":["_node_modules_vue_loader_lib_runtime_component_normalizer__WEBPACK_IMPORTED_MODULE_2__","__webpack_require__","__vue_styles__","context","Component","Object","_babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_analyser_page_vue__WEBPACK_IMPORTED_MODULE_0___default","a","_node_modules_vue_loader_lib_template_compiler_index_id_data_v_6c39893f_hasScoped_true_optionsId_0_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_analyser_page_vue__WEBPACK_IMPORTED_MODULE_1__","__webpack_exports__","d","staticRenderFns","render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_l","analysis","index","directives","name","rawName","key","attrs","title","description","on","click","$event","selectAnalysis","_s","currentAnalysis","input","for","getInputId","value","args","expression","id","domProps","target","composing","$set","_e","runAnalysis","ref","d3","_deltaParser","ignoredWords","split","map","str","toLowerCase","_ref","chapters","_ref2","svg","g","maxHeight","maxWidth","wordArray","concat","apply","_toConsumableArray3","default","chapter","GetWordArray","content","word","filter","includes","wordDict","_flow2","_groupBy2","frequencies","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","_getIterator3","_keys2","next","done","hasOwnProperty","push","frequency","length","err","return","orderedFrequencies","_orderBy2","obj","_take2","Error","margin","attr","barHeight","barInnerHeight","barPadding","x","scaleLinear","domain","rangeRound","bar","selectAll","data","enter","append","i","text","clearPrevious","el","innerHTML","makeSvg","offsetWidth","select","style","safelyRunAnalysis","analysisFn","onError","e","_sweetalert2","icon","all","inputs","run","resultsWindow","unarchivedChapters","archived","validateArgs","wordArg","Word","chapterResults","result","Math","max","y","call","axisBottom","tickFormat","substring","tickValues","_range2","axisLeft","line","datum","Analyses","_analyses2","tooltip","_tooltip2"],"mappings":"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","file":"static/js/7.e481da66a07016939c23.js","sourcesContent":["function injectStyle (context) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6c39893f\\\",\\\"scoped\\\":true,\\\"sourceMap\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./analyser.page.vue\")\n}\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./analyser.page.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./analyser.page.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6c39893f\\\",\\\"hasScoped\\\":true,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./analyser.page.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-6c39893f\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../../../node_modules/vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"analyser-wrap\"},[_c('div',{staticClass:\"analyser\"},[_c('div',{staticClass:\"analyses\"},[_c('h4',{staticClass:\"analysis-title\"},[_vm._v(\"\\n        Select an analysis:\\n      \")]),_vm._v(\" \"),_vm._l((_vm.Analyses),function(analysis,index){return _c('button',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\"}],key:index,staticClass:\"analysis-button\",attrs:{\"title\":analysis.description},on:{\"click\":function($event){_vm.selectAnalysis(analysis)}}},[_vm._v(\"\\n        \"+_vm._s(analysis.title)+\"\\n      \")])})],2),_vm._v(\" \"),(_vm.currentAnalysis)?_c('div',{staticClass:\"analysis-inputs\"},[(_vm.showInputs)?[_c('h4',{staticClass:\"analysis-title\"},[_vm._v(\"\\n          Enter desired inputs:\\n        \")]),_vm._v(\" \"),_vm._l((_vm.currentAnalysis.inputs),function(input,index){return _c('div',{key:index,staticClass:\"analysis-input\"},[_c('label',{attrs:{\"for\":_vm.getInputId(input)}},[_vm._v(_vm._s(input))]),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.currentAnalysis.args[input]),expression:\"currentAnalysis.args[input]\"}],attrs:{\"id\":_vm.getInputId(input)},domProps:{\"value\":(_vm.currentAnalysis.args[input])},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.currentAnalysis.args, input, $event.target.value)}}})])})]:_vm._e(),_vm._v(\" \"),_c('button',{staticClass:\"analysis-button button-green\",on:{\"click\":function($event){_vm.runAnalysis(_vm.currentAnalysis)}}},[_vm._v(\"Run the analysis\")])],2):_vm._e(),_vm._v(\" \"),_c('div',{ref:\"results\",staticClass:\"results\"})])])}\nvar staticRenderFns = []\nexport { render, staticRenderFns }","import flow from 'lodash/fp/flow'\r\nimport groupBy from 'lodash/fp/groupBy'\r\nimport orderBy from 'lodash/fp/orderBy'\r\nimport take from 'lodash/fp/take'\r\nimport * as d3 from 'd3'\r\nimport { GetWordArray } from '../shared/deltaParser'\r\n\r\nconst ignoredWords = `\r\n  the a an\r\n  and but not or\r\n  I me we us you she her he him they them it\r\n  I've I'll I'd we've we'll we'd you've you'll you'd\r\n  she's she'll she'd he's he'll he'd they've they'll they'd\r\n  it's it'll it'd\r\n  I'm you're they're\r\n  myself ourself ourselves yourself yourselves\r\n  herself himself theirself theirselves themselves\r\n  my mine our ours your yours hers his their theirs its\r\n  to from of in for as with so at by on\r\n  be being is was were would will\r\n  do doing did done go going went\r\n  have having had\r\n  that those this these\r\n  not\r\n  what who which`\r\n  .split(/\\s/).map(str => str.toLowerCase())\r\n\r\nconst CommonWords = ({ g: svg, maxHeight, maxWidth }, chapters) => {\r\n  const wordArray = [].concat(...chapters.map(\r\n    chapter => GetWordArray(chapter.content)\r\n      .map(word => word.toLowerCase())\r\n      .filter(word => !ignoredWords.includes(word))\r\n  ))\r\n\r\n  const wordDict = flow(\r\n    groupBy(word => word)\r\n  )(wordArray)\r\n\r\n  const frequencies = []\r\n  for (var key of Object.keys(wordDict)) {\r\n    if (!wordDict.hasOwnProperty(key)) {\r\n      return\r\n    }\r\n\r\n    frequencies.push({\r\n      frequency: wordDict[key].length,\r\n      word: key\r\n    })\r\n  }\r\n\r\n  const orderedFrequencies = flow(\r\n    orderBy([obj => obj.frequency], ['desc']),\r\n    take(10)\r\n  )(frequencies)\r\n\r\n  if (!orderedFrequencies.length) {\r\n    throw new Error('No content was found.')\r\n  }\r\n\r\n  const margin = { bottom: 20, left: 20, top: 20, right: 20 }\r\n  const g = svg.attr('transform', `translate(${margin.left}, ${margin.top})`)\r\n\r\n  const barHeight = (maxHeight - margin.bottom - margin.top) / orderedFrequencies.length\r\n  const barPadding = 6\r\n  const barInnerHeight = barHeight - (barPadding * 2)\r\n  const barRightPad = 50\r\n\r\n  const x = d3.scaleLinear()\r\n  .domain([0, orderedFrequencies[0].frequency])\r\n  .rangeRound([0, maxWidth - margin.left - margin.right - barRightPad])\r\n\r\n  const y = index => index * barHeight\r\n\r\n  const bar = g.selectAll('g').data(orderedFrequencies).enter().append('g')\r\n\r\n  bar.append('rect')\r\n  .attr('x', '0').attr('y', barPadding)\r\n  .attr('height', barInnerHeight)\r\n  .attr('width', d => x(d.frequency))\r\n  .attr('fill', '#90caf9')\r\n\r\n  bar.attr('transform', (d, i) => `translate(0, ${y(i)})`)\r\n    .append('text')\r\n    .text(d => d.word)\r\n    .attr('font-size', '14')\r\n    .attr('x', '5').attr('y', `${barInnerHeight}`)\r\n\r\n  bar.append('text')\r\n    .text(d => d.frequency)\r\n    .attr('font-size', '14')\r\n    .attr('x', d => x(d.frequency) + 6).attr('y', `${barInnerHeight}`)\r\n}\r\n\r\nexport default CommonWords\r\n","/*\r\nAnalysis: {\r\n  description String,\r\n  inputs String[],\r\n  run (resultsWindow HTMLElement, document Delta, args Object),\r\n  title String\r\n}\r\n*/\r\n\r\nimport CommonWords from './commonWords.analysis'\r\nimport * as d3 from 'd3'\r\nimport swal from 'sweetalert'\r\nimport WordOverTime from './wordOverTime.analysis'\r\n\r\nconst clearPrevious = (el) => {\r\n  el.innerHTML = ''\r\n}\r\n\r\nconst makeSvg = (el) => {\r\n  const maxHeight = 400\r\n  const maxWidth = el.offsetWidth\r\n  const g = d3.select(el)\r\n    .append('svg')\r\n    .style('background-color', '#FFF')\r\n    .attr('height', maxHeight)\r\n    .attr('width', maxWidth)\r\n    .append('g')\r\n\r\n  return { g, maxHeight, maxWidth }\r\n}\r\n\r\nconst safelyRunAnalysis = (analysisFn, args, onError) => {\r\n  try {\r\n    analysisFn(...args)\r\n  } catch (e) {\r\n    swal({\r\n      icon: 'error',\r\n      text: e\r\n    })\r\n    onError()\r\n  }\r\n}\r\n\r\nconst validateArgs = (inputs, args) => {\r\n  for (const input of inputs) {\r\n    if (!args[input]) {\r\n      swal({\r\n        icon: 'error',\r\n        text: `Please fill in all required inputs.`\r\n      })\r\n      return false\r\n    }\r\n  }\r\n  return true\r\n}\r\n\r\nconst wordFrequency = {\r\n  description:\r\n    `Find your top 10 most frequently used words (ignoring common English words like \"the\")`,\r\n  inputs: null,\r\n  run (resultsWindow, { chapters }) {\r\n    clearPrevious(resultsWindow)\r\n\r\n    const unarchivedChapters = chapters.filter(chapter => !chapter.archived && !!chapter.content)\r\n\r\n    safelyRunAnalysis(\r\n      CommonWords,\r\n      [makeSvg(resultsWindow), unarchivedChapters],\r\n      () => clearPrevious(resultsWindow)\r\n    )\r\n  },\r\n  title: 'Most common words'\r\n}\r\n\r\nconst wordOverTime = {\r\n  description: 'Track your usage of a specific word in each chapter',\r\n  inputs: ['Word'],\r\n  run (resultsWindow, { chapters }, args) {\r\n    if (!validateArgs(this.inputs, args)) {\r\n      return\r\n    }\r\n    clearPrevious(resultsWindow)\r\n\r\n    const unarchivedChapters = chapters.filter(chapter => !chapter.archived && !!chapter.content)\r\n\r\n    safelyRunAnalysis(\r\n      WordOverTime,\r\n      [makeSvg(resultsWindow), unarchivedChapters, args],\r\n      () => clearPrevious(resultsWindow)\r\n    )\r\n  },\r\n  title: 'Word over time'\r\n}\r\n\r\nconst all = [\r\n  wordFrequency,\r\n  wordOverTime\r\n].map(analysis => {\r\n  analysis.args = {}\r\n  return analysis\r\n})\r\n\r\nexport default all\r\n","import * as d3 from 'd3'\r\nimport { GetWordArray } from '../shared/deltaParser'\r\nimport range from 'lodash/range'\r\n\r\nconst WordOverTime = ({ g: svg, maxWidth, maxHeight }, chapters, { Word: wordArg }) => {\r\n  const chapterResults = []\r\n\r\n  for (const chapter of chapters) {\r\n    const words = GetWordArray(chapter.content)\r\n    const frequency = words.filter(word => word.toLowerCase() === wordArg.toLowerCase()).length\r\n    chapterResults.push({\r\n      frequency,\r\n      title: chapter.title\r\n    })\r\n  }\r\n\r\n  const frequencies = chapterResults.map(result => result.frequency)\r\n\r\n  const domain = [0, Math.max(...frequencies)]\r\n  const margin = { bottom: 40, left: 30, top: 20, right: 50 }\r\n\r\n  // Create svg and g and position with a margin\r\n  const g = svg.attr('transform', `translate(${margin.left}, ${margin.top})`)\r\n\r\n  const x = d3.scaleLinear()\r\n    .domain([1, chapterResults.length])\r\n    .rangeRound([0, maxWidth - margin.left - margin.right])\r\n\r\n  const y = d3.scaleLinear()\r\n    .domain(domain)\r\n    .rangeRound([maxHeight - margin.bottom - margin.top, 0])\r\n\r\n  g.append('g')\r\n    .attr('transform', `translate(0, ${maxHeight - margin.bottom - margin.top})`)\r\n    .call(\r\n      d3.axisBottom(x)\r\n        .tickFormat(i => truncate(chapterResults[i - 1].title, 20))\r\n        .tickValues(range(1, chapterResults.length + 1))\r\n    )\r\n    .selectAll('text')\r\n    .attr('transform', 'rotate(-8)')\r\n\r\n  g.append('g')\r\n    .attr('transform', `translate(0, 0)`)\r\n    .call(d3.axisLeft(y))\r\n\r\n  const line = d3.line()\r\n    .x((d, index) => x(index + 1))\r\n    .y(d => y(d.frequency))\r\n\r\n  g.append('path')\r\n    .datum(chapterResults)\r\n    .attr('fill', 'none')\r\n    .attr('stroke', '#0d47a1')\r\n    .attr('stroke-linejoin', 'bevel')\r\n    .attr('stroke-linecap', 'round')\r\n    .attr('stroke-width', '2')\r\n    .attr('d', line)\r\n\r\n  g.append('rect')\r\n    .attr('x', '5').attr('y', '-9')\r\n    .attr('height', '22')\r\n    .attr('width', '67')\r\n    .attr('fill', 'rgba(230, 230, 230, 0.8)')\r\n\r\n  g.append('text')\r\n    .attr('font-size', '12')\r\n    .attr('x', '10')\r\n    .attr('y', '5')\r\n    .text('Occurrences')\r\n}\r\n\r\nfunction truncate (str, length) {\r\n  if (str.length < length) {\r\n    return str\r\n  }\r\n\r\n  return `${str.substring(0, length)}...`\r\n}\r\n\r\nexport default WordOverTime\r\n","<template>\r\n  <div class=\"analyser-wrap\">\r\n    <div class=\"analyser\">\r\n      <div class=\"analyses\">\r\n        <h4 class=\"analysis-title\">\r\n          Select an analysis:\r\n        </h4>\r\n        <button class=\"analysis-button\" v-for=\"(analysis, index) in Analyses\" :key=\"index\"\r\n                @click=\"selectAnalysis(analysis)\" :title=\"analysis.description\" v-tooltip>\r\n          {{ analysis.title }}\r\n        </button>\r\n      </div>\r\n      <div class=\"analysis-inputs\" v-if=\"currentAnalysis\">\r\n        <template v-if=\"showInputs\">\r\n          <h4 class=\"analysis-title\">\r\n            Enter desired inputs:\r\n          </h4>\r\n          <div class=\"analysis-input\" v-for=\"(input, index) in currentAnalysis.inputs\" :key=\"index\">\r\n            <label :for=\"getInputId(input)\">{{ input }}</label>\r\n            <input :id=\"getInputId(input)\" v-model=\"currentAnalysis.args[input]\">\r\n          </div>\r\n        </template>\r\n        <button class=\"analysis-button button-green\" @click=\"runAnalysis(currentAnalysis)\">Run the analysis</button>\r\n      </div>\r\n      <div class=\"results\" ref=\"results\"></div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Analyses from './analyses'\r\nimport tooltip from '../shared/tooltip.directive'\r\n\r\nexport default {\r\n  computed: {\r\n    document () {\r\n      return this.$store.state.chapters\r\n    },\r\n    showInputs () {\r\n      return (this.currentAnalysis &&\r\n             this.currentAnalysis.inputs &&\r\n             this.currentAnalysis.inputs.length)\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      Analyses,\r\n      currentAnalysis: null\r\n    }\r\n  },\r\n  directives: {\r\n    tooltip\r\n  },\r\n  methods: {\r\n    getInputId (input) {\r\n      return `input-${input}`\r\n    },\r\n    runAnalysis (analysis) {\r\n      analysis.run(this.$refs.results, this.document, analysis.args)\r\n    },\r\n    selectAnalysis (analysis) {\r\n      this.currentAnalysis = analysis\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.analyser-wrap {\r\n  display: flex;\r\n  justify-content: center;\r\n  width: 100%;\r\n}\r\n\r\n.analyser {\r\n  display: block;\r\n  flex: 1;\r\n  max-width: 1050px;\r\n}\r\n\r\n.analyses {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.analysis-button {\r\n  margin-right: 6px;\r\n  margin-top: 12px;\r\n}\r\n\r\n.results {\r\n  margin-top: 12px;\r\n}\r\n</style>\r\n"],"sourceRoot":""}