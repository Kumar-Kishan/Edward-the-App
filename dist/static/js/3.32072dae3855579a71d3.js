(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"5icb":function(t,e,n){var i=n("9F5v");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n("SZ7m").default)("1c89a9f6",i,!0,{})},"9F5v":function(t,e,n){(t.exports=n("I1BE")(!0)).push([t.i,".wrap[data-v-26e78664]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:100%}.exporter[data-v-26e78664]{display:block;-webkit-box-flex:1;-ms-flex:1;flex:1;max-width:1050px}.export-option[data-v-26e78664]{margin-bottom:16px}.export-checkbox[data-v-26e78664]{margin-top:8px}.export-button[data-v-26e78664]{margin:10px 0}.file-input-container[data-v-26e78664]{cursor:pointer;display:inline-block;position:relative}.file-input-label[data-v-26e78664]{bottom:0;cursor:pointer;left:0;opacity:0;padding:0;position:absolute;right:0;top:0}.file-input[data-v-26e78664]{border:none;position:absolute;visibility:hidden}.file-dummy-button[data-v-26e78664]{pointer-events:none}","",{version:3,sources:["C:/code/Edward-the-App/src/app/exporter/exporter.page.vue"],names:[],mappings:"AACA,uBACE,oBAAqB,AACrB,oBAAqB,AACrB,aAAc,AACd,wBAAyB,AACrB,qBAAsB,AAClB,uBAAwB,AAChC,UAAY,CACb,AACD,2BACE,cAAe,AACf,mBAAoB,AAChB,WAAY,AACR,OAAQ,AAChB,gBAAkB,CACnB,AACD,gCACE,kBAAoB,CACrB,AACD,kCACE,cAAgB,CACjB,AACD,gCACE,aAAe,CAChB,AACD,uCACE,eAAgB,AAChB,qBAAsB,AACtB,iBAAmB,CACpB,AACD,mCACE,SAAU,AACV,eAAgB,AAChB,OAAQ,AACR,UAAW,AACX,UAAW,AACX,kBAAmB,AACnB,QAAS,AACT,KAAO,CACR,AACD,6BACE,YAAa,AACb,kBAAmB,AACnB,iBAAmB,CACpB,AACD,oCACE,mBAAqB,CACtB",file:"exporter.page.vue",sourcesContent:["\n.wrap[data-v-26e78664] {\r\n  display: -webkit-box;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -webkit-box-pack: center;\r\n      -ms-flex-pack: center;\r\n          justify-content: center;\r\n  width: 100%;\n}\n.exporter[data-v-26e78664] {\r\n  display: block;\r\n  -webkit-box-flex: 1;\r\n      -ms-flex: 1;\r\n          flex: 1;\r\n  max-width: 1050px;\n}\n.export-option[data-v-26e78664] {\r\n  margin-bottom: 16px;\n}\n.export-checkbox[data-v-26e78664] {\r\n  margin-top: 8px;\n}\n.export-button[data-v-26e78664] {\r\n  margin: 10px 0;\n}\n.file-input-container[data-v-26e78664] {\r\n  cursor: pointer;\r\n  display: inline-block;\r\n  position: relative;\n}\n.file-input-label[data-v-26e78664] {\r\n  bottom: 0;\r\n  cursor: pointer;\r\n  left: 0;\r\n  opacity: 0;\r\n  padding: 0;\r\n  position: absolute;\r\n  right: 0;\r\n  top: 0;\n}\n.file-input[data-v-26e78664] {\r\n  border: none;\r\n  position: absolute;\r\n  visibility: hidden;\n}\n.file-dummy-button[data-v-26e78664] {\r\n  pointer-events: none;\n}\r\n"],sourceRoot:""}])},O9dL:function(t,e,n){"use strict";n.r(e);var i=n("m1cH"),o=n.n(i),r=n("GQeE"),a=n.n(r),l=n("gDS+"),c=n.n(l),u=n("4d7F"),s=n.n(u),d=n("JEAp"),p=n.n(d),A=n("fyQS"),h=n("hhQR"),v=n.n(h),f=n("FyfS"),x=n.n(f),m=n("vmyb"),C=n.n(m);n("xgwA");var b=function(t,e){return new s.a(function(n){var i,r={content:[{text:t,style:"title"}],styles:{body:{fontSize:12},bold:{bold:!0},blockquote:{margin:[10,10,0,10]},chapterHeading:{fontSize:20,margin:[5,10]},h1:{fontSize:18},h2:{fontSize:16},h3:{fontSize:14},italic:{italics:!0},strike:{decoration:"lineThrough"},title:{fontSize:40},underline:{decoration:"underline"}}},a=[];function l(t,e){return{text:t||"",style:e||[]}}var c=!0,u=!1,s=void 0;try{for(var d,p=x()(e);!(c=(d=p.next()).done);c=!0){var A=d.value;a.push({text:A.title,style:"chapterHeading",pageBreak:"before"});var h={text:[],style:[]},f=A.content&&A.content.ops||[],m=!0,b=!1,g=void 0;try{for(var B,w=x()(f);!(m=(B=w.next()).done);m=!0){var k,_=B.value,E=_.insert,D=y(_.attributes),T=D.styles,S=D.lineStyles;if(S.length)(k=h.style).push.apply(k,o()(S));if("\n"!==E)if(E.includes("\n")){var P=E.split("\n"),F=v()(P),I=F[0],O=F.slice(1);if(I){var j=l(I,T);h.text.push(j)}a.push(h),h={text:[],style:[]};for(var $=0;$<O.length-1;$++){var q=l(O[$],T);h.text.push(q),a.push(h),h={text:[],style:[]}}var U=l(O[O.length-1],T);h.text.push(U)}else{var J=l(E,T);h.text.push(J)}else a.push(h),h={text:[],style:[]}}}catch(t){b=!0,g=t}finally{try{!m&&w.return&&w.return()}finally{if(b)throw g}}}}catch(t){u=!0,s=t}finally{try{!c&&p.return&&p.return()}finally{if(u)throw s}}var L=1;a.forEach(function(t){return t.style.includes("ul")?(t.ul=[{text:t.text}],L=1,t.text=null):t.style.includes("ol")?(t.ol=[{text:t.text}],t.start=L++,t.text=null):L=1,t}),r.content=(i=r.content).concat.apply(i,a),C.a.createPdf(r).download(t+".pdf"),n()})},g={bullet:"ul",ordered:"ol"};function y(t){var e=[],n=[];if(!t)return{styles:e,lineStyles:n};for(var i in t)["bold","italic","underline","strike"].includes(i)?e.push(i):"header"!==i?"blockquote"!==i?"list"!==i||n.push(g[t[i]]):n.push("blockquote"):n.push("h"+t[i]);return{styles:e,lineStyles:n}}var B=n("j9tD"),w=n("il2d"),k=n("UUVB"),_=n("GUC0"),E=n.n(_),D={components:{PulseLoader:w.a},computed:{allChapters:function(){return this.$store.state.chapters.chapters},allPlans:function(){return this.$store.state.chapters.plans},allTopics:function(){return this.$store.state.chapters.topics},documentGuid:function(){return this.$store.state.document.currentDocument.guid},documentTitle:function(){return this.$store.state.document.currentDocument.name},isPremium:function(){return this.$store.state.user.user.isPremium},masterTopics:function(){return this.$store.state.chapters.topics}},data:function(){return{includeArchived:!1,loading:!1}},methods:{importBackup:function(t){var e=this;this.loading=!0;var n=void 0;(function(t){return new s.a(function(e,n){var i=new FileReader;i.onload=function(){try{var t=i.result;e(JSON.parse(t))}catch(t){n(t)}},i.readAsText(t)})})(t).then(function(t){return(n=t).guid=e.documentGuid,n.name=e.documentTitle,k.b.then(function(t){return t.docImport(n)})}).then(function(t){e.loading=!1,Object(A.b)(),E()({icon:"success",text:"The document has been imported.",title:"Success"}).then(function(){return e.$store.dispatch(B.b,{guid:e.documentGuid,name:e.documentTitle})})},function(t){throw e.loading=!1,E()({icon:"error",text:'Could not import the document. DETAILS: "'+t+'"',title:"Failure"}),t})},exportJsonDocument:function(){var t=this;this.loading=!0,k.b.then(function(e){return e.docExport(t.documentGuid,t.documentTitle)}).then(function(e){(function(t,e){return new s.a(function(n){var i=c()(e),o=new Blob([i],{type:"application/json"}),r=new Date,a=r.getDate()+"."+(r.getMonth()+1)+"."+r.getFullYear();p.a.saveAs(o,t+"--"+a+".json"),n()})})(t.documentTitle,e).then(function(){t.loading=!1},function(e){throw t.loading=!1,E()({icon:"error",text:'Could not export the document. DETAILS: "'+e+'"'}),e})})},exportPdfChapters:function(){var t=this;this.loading=!0;var e=this.allChapters.filter(function(e){return!e.archived||t.includeArchived});b(this.documentTitle,e).then(function(){t.loading=!1},function(e){throw t.loading=!1,E()({icon:"error",text:'Could not export the document. DETAILS: "'+e+'"'}),e})},exportPdfOutlines:function(){var t,e=this;this.loading=!0;var n=this.allChapters.filter(function(t){return!t.archived||e.includeArchived}).map(function(t){return a()(t.topics).map(function(n){var i=t.topics[n],o=e.getMasterTopic(i);return i.archived=o.archived,i.title=t.title+" - "+o.title,i}).filter(function(t){return!t.archived||e.includeArchived})}),i=(t=[]).concat.apply(t,o()(n));b(this.documentTitle+": Outlines",i).then(function(){e.loading=!1},function(t){throw e.loading=!1,E()({icon:"error",text:'Could not export outlines. DETAILS: "'+t+'"'}),t})},exportPdfPlans:function(){var t,e=this;this.loading=!0;var n=this.allPlans.filter(function(t){return!t.archived||e.includeArchived}).map(function(t){return t.sections.filter(function(t){return!t.archived||e.includeArchived}).map(function(e){return{title:t.title===e.title?t.title:t.title+" - "+e.title,content:e.content}})}),i=(t=[]).concat.apply(t,o()(n));b(this.documentTitle+": Plans",i).then(function(){e.loading=!1},function(t){throw e.loading=!1,E()({icon:"error",text:'Could not export plans. DETAILS: "'+t+'"'}),t})},getMasterTopic:function(t){return this.masterTopics.find(function(e){return e.guid===t.guid})},setFile:function(t){var e=this;E()({buttons:!0,dangerMode:!0,icon:"warning",text:"Are you sure you want to import this file? It will overwrite everything in the current document.",title:"Overwrite current document?"}).then(function(n){n&&e.importBackup(t.target.files[0])})}}},T=n("JFUb");var S=function(t){n("5icb")},P=Object(T.a)(D,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrap"},[n("div",{staticClass:"exporter"},[n("div",{staticClass:"export-option"},[n("h3",[t._v("Export to PDF")]),t._v(" "),n("div",[t._v("(You can open PDFs in Microsoft Word.)")]),t._v(" "),t.loading?n("pulse-loader"):t._e(),t._v(" "),n("div",{staticClass:"export-checkbox"},[t.loading?t._e():n("input",{directives:[{name:"model",rawName:"v-model",value:t.includeArchived,expression:"includeArchived"}],attrs:{id:"includeArchived",type:"checkbox"},domProps:{checked:Array.isArray(t.includeArchived)?t._i(t.includeArchived,null)>-1:t.includeArchived},on:{change:function(e){var n=t.includeArchived,i=e.target,o=!!i.checked;if(Array.isArray(n)){var r=t._i(n,null);i.checked?r<0&&(t.includeArchived=n.concat([null])):r>-1&&(t.includeArchived=n.slice(0,r).concat(n.slice(r+1)))}else t.includeArchived=o}}}),t._v(" "),t.loading?t._e():n("label",{attrs:{for:"includeArchived"}},[t._v("Include Archived")])]),t._v(" "),t.loading?t._e():n("button",{staticClass:"button-green export-button",on:{click:function(e){t.exportPdfChapters()}}},[t._v("\n        Export all chapters\n      ")]),t._v(" "),t.loading?t._e():n("button",{staticClass:"button-green export-button",on:{click:function(e){t.exportPdfPlans()}}},[t._v("\n        Export all plans\n      ")]),t._v(" "),t.loading?t._e():n("button",{staticClass:"button-green export-button",on:{click:function(e){t.exportPdfOutlines()}}},[t._v("\n        Export all outlines\n      ")])],1),t._v(" "),n("div",{staticClass:"export-option"},[n("h3",[t._v("Create a backup")]),t._v(" "),n("div",[t._v("(You can recover your document from this file later.)")]),t._v(" "),t.loading?n("pulse-loader"):t._e(),t._v(" "),t.loading?t._e():n("button",{staticClass:"button-green export-button",on:{click:function(e){t.exportJsonDocument()}}},[t._v("\n        Export entire document\n      ")])],1),t._v(" "),n("div",{staticClass:"export-option"},[n("h3",[t._v("Import a backup")]),t._v(" "),n("div",[t._v("\n        (Warning: This will overwrite the current document completely, including all chapters, plans and outlines.)\n      ")]),t._v(" "),n("div",{staticClass:"file-input-container"},[t.loading?n("pulse-loader"):t._e(),t._v(" "),t.loading?t._e():[n("label",{staticClass:"file-input-label",attrs:{for:"import-file-picker"}}),t._v(" "),n("input",{staticClass:"file-input",attrs:{id:"import-file-picker",type:"file",accept:".json"},on:{change:t.setFile}}),t._v(" "),n("button",{staticClass:"button-green export-button file-dummy-button"},[t._v("\n            Import entire document\n          ")])]],2)])])])},[],!1,S,"data-v-26e78664",null);e.default=P.exports}}]);
//# sourceMappingURL=3.32072dae3855579a71d3.js.map